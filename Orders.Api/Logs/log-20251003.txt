2025-10-03 00:54:56.046 +03:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-10-03 00:54:56.135 +03:00 [INF] Executed DbCommand (14ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsLock' AND "type" = 'table';
2025-10-03 00:54:56.151 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT OR IGNORE INTO "__EFMigrationsLock"("Id", "Timestamp") VALUES(1, '2025-10-02 21:54:56.1438729+00:00');
SELECT changes();
2025-10-03 00:54:56.207 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" TEXT NOT NULL CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY,
    "ProductVersion" TEXT NOT NULL
);
2025-10-03 00:54:56.216 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-03 00:54:56.221 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-03 00:54:56.230 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-10-03 00:54:56.234 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "__EFMigrationsLock";
2025-10-03 00:54:56.440 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u")
2025-10-03 00:54:56.689 +03:00 [INF] Now listening on: http://localhost:5238
2025-10-03 00:54:56.694 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-10-03 00:54:56.696 +03:00 [INF] Hosting environment: Development
2025-10-03 00:54:56.698 +03:00 [INF] Content root path: C:\Users\Zeink\OneDrive\Desktop\backendtest\OrdersAssessment\Orders.Api
2025-10-03 00:55:12.352 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5238/ - null null
2025-10-03 00:55:12.408 +03:00 [WRN] Failed to determine the https port for redirect.
2025-10-03 00:55:12.411 +03:00 [INF] Executing endpoint 'HTTP: GET /'
2025-10-03 00:55:12.418 +03:00 [INF] Executing RedirectResult, redirecting to /swagger.
2025-10-03 00:55:12.420 +03:00 [INF] Executed endpoint 'HTTP: GET /'
2025-10-03 00:55:12.424 +03:00 [INF] HTTP GET / responded 302 in 37.5323 ms
2025-10-03 00:55:12.435 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5238/ - 302 0 null 86.0096ms
2025-10-03 00:55:12.664 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5238/swagger/v1/swagger.json - null null
2025-10-03 00:55:12.878 +03:00 [INF] HTTP GET /swagger/v1/swagger.json responded 200 in 205.8080 ms
2025-10-03 00:55:12.882 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5238/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 217.63ms
2025-10-03 00:55:32.114 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5238/api/Orders - application/json 54
2025-10-03 00:55:32.121 +03:00 [INF] Executing endpoint 'Orders.Api.Controllers.OrdersController.Create (Orders.Api)'
2025-10-03 00:55:32.155 +03:00 [INF] Route matched with {action = "Create", controller = "Orders"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Orders.Application.DTOs.OrderResponse]] Create(Orders.Application.DTOs.CreateOrderRequest, System.Threading.CancellationToken) on controller Orders.Api.Controllers.OrdersController (Orders.Api).
2025-10-03 00:55:32.423 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."Id", "u"."CreatedAtUtc", "u"."Email", "u"."FullName", "u"."PasswordHash", "u"."UpdatedAtUtc"
FROM "Users" AS "u"
WHERE "u"."Id" = @__id_0
LIMIT 1
2025-10-03 00:55:32.440 +03:00 [INF] Executed action Orders.Api.Controllers.OrdersController.Create (Orders.Api) in 277.057ms
2025-10-03 00:55:32.443 +03:00 [INF] Executed endpoint 'Orders.Api.Controllers.OrdersController.Create (Orders.Api)'
2025-10-03 00:55:32.446 +03:00 [ERR] HTTP POST /api/Orders responded 500 in 324.6320 ms
System.InvalidOperationException: User not found.
   at Orders.Application.Services.OrderService.CreateOrderAsync(CreateOrderRequest req, CancellationToken ct) in C:\Users\Zeink\OneDrive\Desktop\backendtest\OrdersAssessment\Orders.Application\Services\OrderService.cs:line 30
   at Orders.Api.Controllers.OrdersController.Create(CreateOrderRequest req, CancellationToken ct) in C:\Users\Zeink\OneDrive\Desktop\backendtest\OrdersAssessment\Orders.Api\Controllers\OrdersController.cs:line 39
   at lambda_method13(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
2025-10-03 00:55:32.497 +03:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: User not found.
   at Orders.Application.Services.OrderService.CreateOrderAsync(CreateOrderRequest req, CancellationToken ct) in C:\Users\Zeink\OneDrive\Desktop\backendtest\OrdersAssessment\Orders.Application\Services\OrderService.cs:line 30
   at Orders.Api.Controllers.OrdersController.Create(CreateOrderRequest req, CancellationToken ct) in C:\Users\Zeink\OneDrive\Desktop\backendtest\OrdersAssessment\Orders.Api\Controllers\OrdersController.cs:line 39
   at lambda_method13(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-10-03 00:55:32.518 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5238/api/Orders - 500 null text/plain; charset=utf-8 403.6104ms
2025-10-03 00:56:11.323 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5238/api/Orders - application/json 54
2025-10-03 00:56:11.329 +03:00 [INF] Executing endpoint 'Orders.Api.Controllers.OrdersController.Create (Orders.Api)'
2025-10-03 00:56:11.332 +03:00 [INF] Route matched with {action = "Create", controller = "Orders"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Orders.Application.DTOs.OrderResponse]] Create(Orders.Application.DTOs.CreateOrderRequest, System.Threading.CancellationToken) on controller Orders.Api.Controllers.OrdersController (Orders.Api).
2025-10-03 00:56:11.400 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."Id", "u"."CreatedAtUtc", "u"."Email", "u"."FullName", "u"."PasswordHash", "u"."UpdatedAtUtc"
FROM "Users" AS "u"
WHERE "u"."Id" = @__id_0
LIMIT 1
2025-10-03 00:56:11.590 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = DateTime), @p2='?' (Size = 5), @p3='?' (DbType = Decimal), @p4='?' (DbType = DateTime), @p5='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Orders" ("Id", "CreatedAtUtc", "Status", "Total", "UpdatedAtUtc", "UserId")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-10-03 00:56:11.609 +03:00 [INF] Executing CreatedAtActionResult, writing value of type 'Orders.Application.DTOs.OrderResponse'.
2025-10-03 00:56:11.671 +03:00 [INF] Executed action Orders.Api.Controllers.OrdersController.Create (Orders.Api) in 335.7669ms
2025-10-03 00:56:11.674 +03:00 [INF] Executed endpoint 'Orders.Api.Controllers.OrdersController.Create (Orders.Api)'
2025-10-03 00:56:11.676 +03:00 [INF] HTTP POST /api/Orders responded 201 in 346.7401 ms
2025-10-03 00:56:11.679 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5238/api/Orders - 201 null application/json; charset=utf-8 355.8213ms
2025-10-03 00:56:43.084 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5238/api/Orders/aca1f7c9-2523-42ee-8886-c6da8bc4116c - null null
2025-10-03 00:56:43.092 +03:00 [INF] Executing endpoint 'Orders.Api.Controllers.OrdersController.GetById (Orders.Api)'
2025-10-03 00:56:43.102 +03:00 [INF] Route matched with {action = "GetById", controller = "Orders"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Orders.Application.DTOs.OrderResponse]] GetById(System.Guid, System.Threading.CancellationToken) on controller Orders.Api.Controllers.OrdersController (Orders.Api).
2025-10-03 00:56:43.182 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "o1"."Id", "o1"."CreatedAtUtc", "o1"."Status", "o1"."Total", "o1"."UpdatedAtUtc", "o1"."UserId", "o0"."Id", "o0"."CreatedAtUtc", "o0"."Name", "o0"."OrderId", "o0"."Quantity", "o0"."UnitPrice", "o0"."UpdatedAtUtc"
FROM (
    SELECT "o"."Id", "o"."CreatedAtUtc", "o"."Status", "o"."Total", "o"."UpdatedAtUtc", "o"."UserId"
    FROM "Orders" AS "o"
    WHERE "o"."Id" = @__id_0
    LIMIT 1
) AS "o1"
LEFT JOIN "OrderItems" AS "o0" ON "o1"."Id" = "o0"."OrderId"
ORDER BY "o1"."Id"
2025-10-03 00:56:43.195 +03:00 [INF] Executing OkObjectResult, writing value of type 'Orders.Application.DTOs.OrderResponse'.
2025-10-03 00:56:43.197 +03:00 [INF] Executed action Orders.Api.Controllers.OrdersController.GetById (Orders.Api) in 91.3113ms
2025-10-03 00:56:43.200 +03:00 [INF] Executed endpoint 'Orders.Api.Controllers.OrdersController.GetById (Orders.Api)'
2025-10-03 00:56:43.202 +03:00 [INF] HTTP GET /api/Orders/aca1f7c9-2523-42ee-8886-c6da8bc4116c responded 200 in 111.1713 ms
2025-10-03 00:56:43.205 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5238/api/Orders/aca1f7c9-2523-42ee-8886-c6da8bc4116c - 200 null application/json; charset=utf-8 120.3846ms
2025-10-03 00:57:10.291 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5238/api/users/22659275-2243-4622-9407-a2fc9d730fb0/orders - null null
2025-10-03 00:57:10.298 +03:00 [INF] Executing endpoint 'Orders.Api.Controllers.OrdersController.GetByUser (Orders.Api)'
2025-10-03 00:57:10.307 +03:00 [INF] Route matched with {action = "GetByUser", controller = "Orders"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.IReadOnlyList`1[Orders.Application.DTOs.OrderResponse]]] GetByUser(System.Guid, System.Threading.CancellationToken) on controller Orders.Api.Controllers.OrdersController (Orders.Api).
2025-10-03 00:57:10.343 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "o"."Id", "o"."CreatedAtUtc", "o"."Status", "o"."Total", "o"."UpdatedAtUtc", "o"."UserId", "o0"."Id", "o0"."CreatedAtUtc", "o0"."Name", "o0"."OrderId", "o0"."Quantity", "o0"."UnitPrice", "o0"."UpdatedAtUtc"
FROM "Orders" AS "o"
LEFT JOIN "OrderItems" AS "o0" ON "o"."Id" = "o0"."OrderId"
WHERE "o"."UserId" = @__userId_0
ORDER BY "o"."CreatedAtUtc" DESC, "o"."Id"
2025-10-03 00:57:10.350 +03:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Orders.Application.DTOs.OrderResponse, Orders.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-03 00:57:10.353 +03:00 [INF] Executed action Orders.Api.Controllers.OrdersController.GetByUser (Orders.Api) in 41.9869ms
2025-10-03 00:57:10.355 +03:00 [INF] Executed endpoint 'Orders.Api.Controllers.OrdersController.GetByUser (Orders.Api)'
2025-10-03 00:57:10.357 +03:00 [INF] HTTP GET /api/users/22659275-2243-4622-9407-a2fc9d730fb0/orders responded 200 in 58.7586 ms
2025-10-03 00:57:10.360 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5238/api/users/22659275-2243-4622-9407-a2fc9d730fb0/orders - 200 null application/json; charset=utf-8 69.4977ms
2025-10-03 00:57:58.146 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5238/api/Orders/aca1f7c9-2523-42ee-8886-c6da8bc4116c/items - application/json 54
2025-10-03 00:57:58.151 +03:00 [INF] Executing endpoint 'Orders.Api.Controllers.OrdersController.AddItem (Orders.Api)'
2025-10-03 00:57:58.157 +03:00 [INF] Route matched with {action = "AddItem", controller = "Orders"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Orders.Application.DTOs.OrderResponse]] AddItem(System.Guid, Orders.Application.DTOs.AddItemRequest, System.Threading.CancellationToken) on controller Orders.Api.Controllers.OrdersController (Orders.Api).
2025-10-03 00:57:58.190 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "o1"."Id", "o1"."CreatedAtUtc", "o1"."Status", "o1"."Total", "o1"."UpdatedAtUtc", "o1"."UserId", "o0"."Id", "o0"."CreatedAtUtc", "o0"."Name", "o0"."OrderId", "o0"."Quantity", "o0"."UnitPrice", "o0"."UpdatedAtUtc"
FROM (
    SELECT "o"."Id", "o"."CreatedAtUtc", "o"."Status", "o"."Total", "o"."UpdatedAtUtc", "o"."UserId"
    FROM "Orders" AS "o"
    WHERE "o"."Id" = @__id_0
    LIMIT 1
) AS "o1"
LEFT JOIN "OrderItems" AS "o0" ON "o1"."Id" = "o0"."OrderId"
ORDER BY "o1"."Id"
2025-10-03 00:57:58.230 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@p6='?' (DbType = Guid), @p0='?' (DbType = DateTime), @p1='?' (Size = 5), @p2='?' (DbType = Guid), @p3='?' (DbType = Int32), @p4='?' (DbType = Decimal), @p5='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE "OrderItems" SET "CreatedAtUtc" = @p0, "Name" = @p1, "OrderId" = @p2, "Quantity" = @p3, "UnitPrice" = @p4, "UpdatedAtUtc" = @p5
WHERE "Id" = @p6
RETURNING 1;
2025-10-03 00:57:58.244 +03:00 [INF] Executed action Orders.Api.Controllers.OrdersController.AddItem (Orders.Api) in 83.129ms
2025-10-03 00:57:58.247 +03:00 [INF] Executed endpoint 'Orders.Api.Controllers.OrdersController.AddItem (Orders.Api)'
2025-10-03 00:57:58.249 +03:00 [ERR] HTTP POST /api/Orders/aca1f7c9-2523-42ee-8886-c6da8bc4116c/items responded 500 in 97.8311 ms
Microsoft.EntityFrameworkCore.DbUpdateConcurrencyException: The database operation was expected to affect 1 row(s), but actually affected 0 row(s); data may have been modified or deleted since entities were loaded. See https://go.microsoft.com/fwlink/?LinkId=527962 for information on understanding and handling optimistic concurrency exceptions.
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ThrowAggregateUpdateConcurrencyExceptionAsync(RelationalDataReader reader, Int32 commandIndex, Int32 expectedRowsAffected, Int32 rowsAffected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetWithRowsAffectedOnlyAsync(Int32 commandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Orders.Application.Services.OrderService.AddItemAsync(Guid orderId, AddItemRequest req, CancellationToken ct) in C:\Users\Zeink\OneDrive\Desktop\backendtest\OrdersAssessment\Orders.Application\Services\OrderService.cs:line 62
   at Orders.Api.Controllers.OrdersController.AddItem(Guid orderId, AddItemRequest req, CancellationToken ct) in C:\Users\Zeink\OneDrive\Desktop\backendtest\OrdersAssessment\Orders.Api\Controllers\OrdersController.cs:line 71
   at lambda_method281(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
2025-10-03 00:57:58.269 +03:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateConcurrencyException: The database operation was expected to affect 1 row(s), but actually affected 0 row(s); data may have been modified or deleted since entities were loaded. See https://go.microsoft.com/fwlink/?LinkId=527962 for information on understanding and handling optimistic concurrency exceptions.
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ThrowAggregateUpdateConcurrencyExceptionAsync(RelationalDataReader reader, Int32 commandIndex, Int32 expectedRowsAffected, Int32 rowsAffected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetWithRowsAffectedOnlyAsync(Int32 commandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Orders.Application.Services.OrderService.AddItemAsync(Guid orderId, AddItemRequest req, CancellationToken ct) in C:\Users\Zeink\OneDrive\Desktop\backendtest\OrdersAssessment\Orders.Application\Services\OrderService.cs:line 62
   at Orders.Api.Controllers.OrdersController.AddItem(Guid orderId, AddItemRequest req, CancellationToken ct) in C:\Users\Zeink\OneDrive\Desktop\backendtest\OrdersAssessment\Orders.Api\Controllers\OrdersController.cs:line 71
   at lambda_method281(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-10-03 00:57:58.288 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5238/api/Orders/aca1f7c9-2523-42ee-8886-c6da8bc4116c/items - 500 null text/plain; charset=utf-8 141.4806ms
2025-10-03 01:06:26.910 +03:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-10-03 01:06:26.975 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsLock' AND "type" = 'table';
2025-10-03 01:06:28.601 +03:00 [INF] Executed DbCommand (1,618ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT OR IGNORE INTO "__EFMigrationsLock"("Id", "Timestamp") VALUES(1, '2025-10-02 22:06:26.9828721+00:00');
SELECT changes();
2025-10-03 01:06:28.681 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" TEXT NOT NULL CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY,
    "ProductVersion" TEXT NOT NULL
);
2025-10-03 01:06:28.762 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-03 01:06:28.772 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-03 01:06:28.794 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-10-03 01:06:29.002 +03:00 [INF] Executed DbCommand (205ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "__EFMigrationsLock";
2025-10-03 01:06:29.207 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u")
2025-10-03 01:06:29.400 +03:00 [INF] Now listening on: http://localhost:5238
2025-10-03 01:06:29.406 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-10-03 01:06:29.409 +03:00 [INF] Hosting environment: Development
2025-10-03 01:06:29.410 +03:00 [INF] Content root path: C:\Users\Zeink\OneDrive\Desktop\backendtest\OrdersAssessment\Orders.Api
2025-10-03 01:07:09.489 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5238/ - null null
2025-10-03 01:07:09.533 +03:00 [WRN] Failed to determine the https port for redirect.
2025-10-03 01:07:09.536 +03:00 [INF] Executing endpoint 'HTTP: GET /'
2025-10-03 01:07:09.542 +03:00 [INF] Executing RedirectResult, redirecting to /swagger.
2025-10-03 01:07:09.545 +03:00 [INF] Executed endpoint 'HTTP: GET /'
2025-10-03 01:07:09.548 +03:00 [INF] HTTP GET / responded 302 in 30.8072 ms
2025-10-03 01:07:09.558 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5238/ - 302 0 null 71.1393ms
2025-10-03 01:07:09.761 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5238/swagger/v1/swagger.json - null null
2025-10-03 01:07:09.868 +03:00 [INF] HTTP GET /swagger/v1/swagger.json responded 200 in 99.3065 ms
2025-10-03 01:07:09.872 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5238/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 110.8358ms
2025-10-03 01:07:45.725 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5238/api/Orders - application/json 54
2025-10-03 01:07:45.731 +03:00 [INF] Executing endpoint 'Orders.Api.Controllers.OrdersController.Create (Orders.Api)'
2025-10-03 01:07:45.761 +03:00 [INF] Route matched with {action = "Create", controller = "Orders"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Orders.Application.DTOs.OrderResponse]] Create(Orders.Application.DTOs.CreateOrderRequest, System.Threading.CancellationToken) on controller Orders.Api.Controllers.OrdersController (Orders.Api).
2025-10-03 01:07:45.973 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."Id", "u"."CreatedAtUtc", "u"."Email", "u"."FullName", "u"."PasswordHash", "u"."UpdatedAtUtc"
FROM "Users" AS "u"
WHERE "u"."Id" = @__id_0
LIMIT 1
2025-10-03 01:07:46.157 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = DateTime), @p2='?' (Size = 5), @p3='?' (DbType = Decimal), @p4='?' (DbType = DateTime), @p5='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Orders" ("Id", "CreatedAtUtc", "Status", "Total", "UpdatedAtUtc", "UserId")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-10-03 01:07:46.174 +03:00 [INF] Executing CreatedAtActionResult, writing value of type 'Orders.Application.DTOs.OrderResponse'.
2025-10-03 01:07:46.231 +03:00 [INF] Executed action Orders.Api.Controllers.OrdersController.Create (Orders.Api) in 464.3569ms
2025-10-03 01:07:46.234 +03:00 [INF] Executed endpoint 'Orders.Api.Controllers.OrdersController.Create (Orders.Api)'
2025-10-03 01:07:46.236 +03:00 [INF] HTTP POST /api/Orders responded 201 in 504.6506 ms
2025-10-03 01:07:46.242 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5238/api/Orders - 201 null application/json; charset=utf-8 516.8089ms
2025-10-03 01:07:57.986 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5238/api/Orders/06032df5-4a80-446f-af4b-1e71f11afb74 - null null
2025-10-03 01:07:57.992 +03:00 [INF] Executing endpoint 'Orders.Api.Controllers.OrdersController.GetById (Orders.Api)'
2025-10-03 01:07:58.000 +03:00 [INF] Route matched with {action = "GetById", controller = "Orders"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Orders.Application.DTOs.OrderResponse]] GetById(System.Guid, System.Threading.CancellationToken) on controller Orders.Api.Controllers.OrdersController (Orders.Api).
2025-10-03 01:07:58.121 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "o1"."Id", "o1"."CreatedAtUtc", "o1"."Status", "o1"."Total", "o1"."UpdatedAtUtc", "o1"."UserId", "o0"."Id", "o0"."CreatedAtUtc", "o0"."Name", "o0"."OrderId", "o0"."Quantity", "o0"."UnitPrice", "o0"."UpdatedAtUtc"
FROM (
    SELECT "o"."Id", "o"."CreatedAtUtc", "o"."Status", "o"."Total", "o"."UpdatedAtUtc", "o"."UserId"
    FROM "Orders" AS "o"
    WHERE "o"."Id" = @__id_0
    LIMIT 1
) AS "o1"
LEFT JOIN "OrderItems" AS "o0" ON "o1"."Id" = "o0"."OrderId"
ORDER BY "o1"."Id"
2025-10-03 01:07:58.132 +03:00 [INF] Executing OkObjectResult, writing value of type 'Orders.Application.DTOs.OrderResponse'.
2025-10-03 01:07:58.134 +03:00 [INF] Executed action Orders.Api.Controllers.OrdersController.GetById (Orders.Api) in 131.3432ms
2025-10-03 01:07:58.137 +03:00 [INF] Executed endpoint 'Orders.Api.Controllers.OrdersController.GetById (Orders.Api)'
2025-10-03 01:07:58.139 +03:00 [INF] HTTP GET /api/Orders/06032df5-4a80-446f-af4b-1e71f11afb74 responded 200 in 146.9732 ms
2025-10-03 01:07:58.142 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5238/api/Orders/06032df5-4a80-446f-af4b-1e71f11afb74 - 200 null application/json; charset=utf-8 155.7277ms
2025-10-03 01:08:24.278 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5238/api/users/22659275-2243-4622-9407-a2fc9d730fb0/orders - null null
2025-10-03 01:08:24.285 +03:00 [INF] Executing endpoint 'Orders.Api.Controllers.OrdersController.GetByUser (Orders.Api)'
2025-10-03 01:08:24.291 +03:00 [INF] Route matched with {action = "GetByUser", controller = "Orders"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.IReadOnlyList`1[Orders.Application.DTOs.OrderResponse]]] GetByUser(System.Guid, System.Threading.CancellationToken) on controller Orders.Api.Controllers.OrdersController (Orders.Api).
2025-10-03 01:08:24.322 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "o"."Id", "o"."CreatedAtUtc", "o"."Status", "o"."Total", "o"."UpdatedAtUtc", "o"."UserId", "o0"."Id", "o0"."CreatedAtUtc", "o0"."Name", "o0"."OrderId", "o0"."Quantity", "o0"."UnitPrice", "o0"."UpdatedAtUtc"
FROM "Orders" AS "o"
LEFT JOIN "OrderItems" AS "o0" ON "o"."Id" = "o0"."OrderId"
WHERE "o"."UserId" = @__userId_0
ORDER BY "o"."CreatedAtUtc" DESC, "o"."Id"
2025-10-03 01:08:24.329 +03:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Orders.Application.DTOs.OrderResponse, Orders.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-03 01:08:24.333 +03:00 [INF] Executed action Orders.Api.Controllers.OrdersController.GetByUser (Orders.Api) in 37.737ms
2025-10-03 01:08:24.337 +03:00 [INF] Executed endpoint 'Orders.Api.Controllers.OrdersController.GetByUser (Orders.Api)'
2025-10-03 01:08:24.338 +03:00 [INF] HTTP GET /api/users/22659275-2243-4622-9407-a2fc9d730fb0/orders responded 200 in 53.4679 ms
2025-10-03 01:08:24.342 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5238/api/users/22659275-2243-4622-9407-a2fc9d730fb0/orders - 200 null application/json; charset=utf-8 63.3409ms
2025-10-03 01:08:48.809 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5238/api/Orders/06032df5-4a80-446f-af4b-1e71f11afb74/items - application/json 58
2025-10-03 01:08:48.815 +03:00 [INF] Executing endpoint 'Orders.Api.Controllers.OrdersController.AddItem (Orders.Api)'
2025-10-03 01:08:48.820 +03:00 [INF] Route matched with {action = "AddItem", controller = "Orders"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Orders.Application.DTOs.OrderResponse]] AddItem(System.Guid, Orders.Application.DTOs.AddItemRequest, System.Threading.CancellationToken) on controller Orders.Api.Controllers.OrdersController (Orders.Api).
2025-10-03 01:08:48.851 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "o1"."Id", "o1"."CreatedAtUtc", "o1"."Status", "o1"."Total", "o1"."UpdatedAtUtc", "o1"."UserId", "o0"."Id", "o0"."CreatedAtUtc", "o0"."Name", "o0"."OrderId", "o0"."Quantity", "o0"."UnitPrice", "o0"."UpdatedAtUtc"
FROM (
    SELECT "o"."Id", "o"."CreatedAtUtc", "o"."Status", "o"."Total", "o"."UpdatedAtUtc", "o"."UserId"
    FROM "Orders" AS "o"
    WHERE "o"."Id" = @__id_0
    LIMIT 1
) AS "o1"
LEFT JOIN "OrderItems" AS "o0" ON "o1"."Id" = "o0"."OrderId"
ORDER BY "o1"."Id"
2025-10-03 01:08:48.895 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = DateTime), @p2='?' (Size = 8), @p3='?' (DbType = Guid), @p4='?' (DbType = Int32), @p5='?' (DbType = Decimal), @p6='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "OrderItems" ("Id", "CreatedAtUtc", "Name", "OrderId", "Quantity", "UnitPrice", "UpdatedAtUtc")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
2025-10-03 01:08:48.900 +03:00 [INF] Executing OkObjectResult, writing value of type 'Orders.Application.DTOs.OrderResponse'.
2025-10-03 01:08:48.904 +03:00 [INF] Executed action Orders.Api.Controllers.OrdersController.AddItem (Orders.Api) in 80.1707ms
2025-10-03 01:08:48.905 +03:00 [INF] Executed endpoint 'Orders.Api.Controllers.OrdersController.AddItem (Orders.Api)'
2025-10-03 01:08:48.907 +03:00 [INF] HTTP POST /api/Orders/06032df5-4a80-446f-af4b-1e71f11afb74/items responded 200 in 92.8418 ms
2025-10-03 01:08:48.910 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5238/api/Orders/06032df5-4a80-446f-af4b-1e71f11afb74/items - 200 null application/json; charset=utf-8 101.1451ms
2025-10-03 01:09:03.451 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5238/api/users/22659275-2243-4622-9407-a2fc9d730fb0/orders - null null
2025-10-03 01:09:03.457 +03:00 [INF] Executing endpoint 'Orders.Api.Controllers.OrdersController.GetByUser (Orders.Api)'
2025-10-03 01:09:03.460 +03:00 [INF] Route matched with {action = "GetByUser", controller = "Orders"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.IReadOnlyList`1[Orders.Application.DTOs.OrderResponse]]] GetByUser(System.Guid, System.Threading.CancellationToken) on controller Orders.Api.Controllers.OrdersController (Orders.Api).
2025-10-03 01:09:03.465 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "o"."Id", "o"."CreatedAtUtc", "o"."Status", "o"."Total", "o"."UpdatedAtUtc", "o"."UserId", "o0"."Id", "o0"."CreatedAtUtc", "o0"."Name", "o0"."OrderId", "o0"."Quantity", "o0"."UnitPrice", "o0"."UpdatedAtUtc"
FROM "Orders" AS "o"
LEFT JOIN "OrderItems" AS "o0" ON "o"."Id" = "o0"."OrderId"
WHERE "o"."UserId" = @__userId_0
ORDER BY "o"."CreatedAtUtc" DESC, "o"."Id"
2025-10-03 01:09:03.472 +03:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Orders.Application.DTOs.OrderResponse, Orders.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-03 01:09:03.476 +03:00 [INF] Executed action Orders.Api.Controllers.OrdersController.GetByUser (Orders.Api) in 12.8901ms
2025-10-03 01:09:03.478 +03:00 [INF] Executed endpoint 'Orders.Api.Controllers.OrdersController.GetByUser (Orders.Api)'
2025-10-03 01:09:03.481 +03:00 [INF] HTTP GET /api/users/22659275-2243-4622-9407-a2fc9d730fb0/orders responded 200 in 23.7645 ms
2025-10-03 01:09:03.484 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5238/api/users/22659275-2243-4622-9407-a2fc9d730fb0/orders - 200 null application/json; charset=utf-8 32.9201ms
2025-10-03 01:10:38.938 +03:00 [INF] Request starting HTTP/1.1 DELETE http://localhost:5238/api/Orders/06032df5-4a80-446f-af4b-1e71f11afb74/items/1f64290d-ca6d-46c3-8e98-28af39366708 - null null
2025-10-03 01:10:38.943 +03:00 [INF] Executing endpoint 'Orders.Api.Controllers.OrdersController.RemoveItem (Orders.Api)'
2025-10-03 01:10:38.950 +03:00 [INF] Route matched with {action = "RemoveItem", controller = "Orders"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Orders.Application.DTOs.OrderResponse]] RemoveItem(System.Guid, System.Guid, System.Threading.CancellationToken) on controller Orders.Api.Controllers.OrdersController (Orders.Api).
2025-10-03 01:10:38.960 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "o1"."Id", "o1"."CreatedAtUtc", "o1"."Status", "o1"."Total", "o1"."UpdatedAtUtc", "o1"."UserId", "o0"."Id", "o0"."CreatedAtUtc", "o0"."Name", "o0"."OrderId", "o0"."Quantity", "o0"."UnitPrice", "o0"."UpdatedAtUtc"
FROM (
    SELECT "o"."Id", "o"."CreatedAtUtc", "o"."Status", "o"."Total", "o"."UpdatedAtUtc", "o"."UserId"
    FROM "Orders" AS "o"
    WHERE "o"."Id" = @__id_0
    LIMIT 1
) AS "o1"
LEFT JOIN "OrderItems" AS "o0" ON "o1"."Id" = "o0"."OrderId"
ORDER BY "o1"."Id"
2025-10-03 01:10:38.981 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@p0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "OrderItems"
WHERE "Id" = @p0
RETURNING 1;
2025-10-03 01:10:38.986 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@p1='?' (DbType = Guid), @p0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Orders" SET "UpdatedAtUtc" = @p0
WHERE "Id" = @p1
RETURNING 1;
2025-10-03 01:10:39.001 +03:00 [INF] Executing OkObjectResult, writing value of type 'Orders.Application.DTOs.OrderResponse'.
2025-10-03 01:10:39.005 +03:00 [INF] Executed action Orders.Api.Controllers.OrdersController.RemoveItem (Orders.Api) in 49.3443ms
2025-10-03 01:10:39.008 +03:00 [INF] Executed endpoint 'Orders.Api.Controllers.OrdersController.RemoveItem (Orders.Api)'
2025-10-03 01:10:39.010 +03:00 [INF] HTTP DELETE /api/Orders/06032df5-4a80-446f-af4b-1e71f11afb74/items/1f64290d-ca6d-46c3-8e98-28af39366708 responded 200 in 67.4170 ms
2025-10-03 01:10:39.014 +03:00 [INF] Request finished HTTP/1.1 DELETE http://localhost:5238/api/Orders/06032df5-4a80-446f-af4b-1e71f11afb74/items/1f64290d-ca6d-46c3-8e98-28af39366708 - 200 null application/json; charset=utf-8 75.9279ms
2025-10-03 02:00:10.522 +03:00 [INF] Application is shutting down...
2025-10-03 15:04:36.500 +03:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-10-03 15:04:36.587 +03:00 [INF] Executed DbCommand (14ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsLock' AND "type" = 'table';
2025-10-03 15:04:36.606 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT OR IGNORE INTO "__EFMigrationsLock"("Id", "Timestamp") VALUES(1, '2025-10-03 12:04:36.5983617+00:00');
SELECT changes();
2025-10-03 15:04:36.676 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" TEXT NOT NULL CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY,
    "ProductVersion" TEXT NOT NULL
);
2025-10-03 15:04:36.686 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-03 15:04:36.695 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-03 15:04:36.709 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-10-03 15:04:36.715 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "__EFMigrationsLock";
2025-10-03 15:04:36.912 +03:00 [INF] User profile is available. Using 'C:\Users\Zeink\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-10-03 15:04:37.133 +03:00 [INF] Now listening on: http://localhost:5238
2025-10-03 15:04:37.138 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-10-03 15:04:37.140 +03:00 [INF] Hosting environment: Development
2025-10-03 15:04:37.142 +03:00 [INF] Content root path: C:\Users\Zeink\OneDrive\Desktop\backendtest\OrdersAssessment\Orders.Api
2025-10-03 15:04:54.203 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5238/ - null null
2025-10-03 15:04:54.261 +03:00 [WRN] Failed to determine the https port for redirect.
2025-10-03 15:04:54.343 +03:00 [INF] Executing endpoint 'HTTP: GET /'
2025-10-03 15:04:54.351 +03:00 [INF] Executing RedirectResult, redirecting to /swagger.
2025-10-03 15:04:54.355 +03:00 [INF] Executed endpoint 'HTTP: GET /'
2025-10-03 15:04:54.359 +03:00 [INF] HTTP GET / responded 302 in 121.8288 ms
2025-10-03 15:04:54.373 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5238/ - 302 0 null 172.7841ms
2025-10-03 15:04:54.573 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5238/swagger/v1/swagger.json - null null
2025-10-03 15:04:54.752 +03:00 [INF] HTTP GET /swagger/v1/swagger.json responded 200 in 170.8497 ms
2025-10-03 15:04:54.757 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5238/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 184.4452ms
2025-10-03 15:06:34.997 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5238/api/Auth/register - application/json 77
2025-10-03 15:06:35.007 +03:00 [INF] Executing endpoint 'Orders.Api.Controllers.AuthController.Register (Orders.Api)'
2025-10-03 15:06:35.046 +03:00 [INF] Route matched with {action = "Register", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Orders.Application.DTOs.AuthResponse]] Register(Orders.Application.DTOs.RegisterRequest, System.Threading.CancellationToken) on controller Orders.Api.Controllers.AuthController (Orders.Api).
2025-10-03 15:06:35.574 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__email_0='?' (Size = 14)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."Id", "u"."CreatedAtUtc", "u"."Email", "u"."FullName", "u"."PasswordHash", "u"."UpdatedAtUtc"
FROM "Users" AS "u"
WHERE "u"."Email" = @__email_0
LIMIT 1
2025-10-03 15:06:35.861 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = DateTime), @p2='?' (Size = 14), @p3='?' (Size = 6), @p4='?' (Size = 84), @p5='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Users" ("Id", "CreatedAtUtc", "Email", "FullName", "PasswordHash", "UpdatedAtUtc")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-10-03 15:06:35.924 +03:00 [INF] Executed action Orders.Api.Controllers.AuthController.Register (Orders.Api) in 870.7335ms
2025-10-03 15:06:35.928 +03:00 [INF] Executed endpoint 'Orders.Api.Controllers.AuthController.Register (Orders.Api)'
2025-10-03 15:06:35.931 +03:00 [ERR] HTTP POST /api/Auth/register responded 500 in 926.4521 ms
System.ArgumentOutOfRangeException: IDX10720: Unable to create KeyedHashAlgorithm for algorithm 'HS256', the key size must be greater than: '256' bits, key has '192' bits. (Parameter 'keyBytes')
   at Microsoft.IdentityModel.Tokens.CryptoProviderFactory.ValidateKeySize(Byte[] keyBytes, String algorithm, Int32 expectedNumberOfBytes)
   at Microsoft.IdentityModel.Tokens.CryptoProviderFactory.CreateKeyedHashAlgorithm(Byte[] keyBytes, String algorithm)
   at Microsoft.IdentityModel.Tokens.SymmetricSignatureProvider.CreateKeyedHashAlgorithm()
   at Microsoft.IdentityModel.Tokens.DisposableObjectPool`1.CreateInstance()
   at Microsoft.IdentityModel.Tokens.DisposableObjectPool`1.Allocate()
   at Microsoft.IdentityModel.Tokens.SymmetricSignatureProvider.GetKeyedHashAlgorithm(Byte[] keyBytes, String algorithm)
   at Microsoft.IdentityModel.Tokens.SymmetricSignatureProvider.Sign(Byte[] input)
   at Microsoft.IdentityModel.JsonWebTokens.JwtTokenUtilities.CreateEncodedSignature(String input, SigningCredentials signingCredentials)
   at System.IdentityModel.Tokens.Jwt.JwtSecurityTokenHandler.WriteToken(SecurityToken token)
   at Orders.Application.Services.AuthService.GenerateToken(User user) in C:\Users\Zeink\OneDrive\Desktop\backendtest\OrdersAssessment\Orders.Application\Services\AuthService.cs:line 68
   at Orders.Application.Services.AuthService.RegisterAsync(RegisterRequest req, CancellationToken ct) in C:\Users\Zeink\OneDrive\Desktop\backendtest\OrdersAssessment\Orders.Application\Services\AuthService.cs:line 38
   at Orders.Api.Controllers.AuthController.Register(RegisterRequest req, CancellationToken ct) in C:\Users\Zeink\OneDrive\Desktop\backendtest\OrdersAssessment\Orders.Api\Controllers\AuthController.cs:line 22
   at lambda_method9(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
2025-10-03 15:06:35.990 +03:00 [ERR] An unhandled exception has occurred while executing the request.
System.ArgumentOutOfRangeException: IDX10720: Unable to create KeyedHashAlgorithm for algorithm 'HS256', the key size must be greater than: '256' bits, key has '192' bits. (Parameter 'keyBytes')
   at Microsoft.IdentityModel.Tokens.CryptoProviderFactory.ValidateKeySize(Byte[] keyBytes, String algorithm, Int32 expectedNumberOfBytes)
   at Microsoft.IdentityModel.Tokens.CryptoProviderFactory.CreateKeyedHashAlgorithm(Byte[] keyBytes, String algorithm)
   at Microsoft.IdentityModel.Tokens.SymmetricSignatureProvider.CreateKeyedHashAlgorithm()
   at Microsoft.IdentityModel.Tokens.DisposableObjectPool`1.CreateInstance()
   at Microsoft.IdentityModel.Tokens.DisposableObjectPool`1.Allocate()
   at Microsoft.IdentityModel.Tokens.SymmetricSignatureProvider.GetKeyedHashAlgorithm(Byte[] keyBytes, String algorithm)
   at Microsoft.IdentityModel.Tokens.SymmetricSignatureProvider.Sign(Byte[] input)
   at Microsoft.IdentityModel.JsonWebTokens.JwtTokenUtilities.CreateEncodedSignature(String input, SigningCredentials signingCredentials)
   at System.IdentityModel.Tokens.Jwt.JwtSecurityTokenHandler.WriteToken(SecurityToken token)
   at Orders.Application.Services.AuthService.GenerateToken(User user) in C:\Users\Zeink\OneDrive\Desktop\backendtest\OrdersAssessment\Orders.Application\Services\AuthService.cs:line 68
   at Orders.Application.Services.AuthService.RegisterAsync(RegisterRequest req, CancellationToken ct) in C:\Users\Zeink\OneDrive\Desktop\backendtest\OrdersAssessment\Orders.Application\Services\AuthService.cs:line 38
   at Orders.Api.Controllers.AuthController.Register(RegisterRequest req, CancellationToken ct) in C:\Users\Zeink\OneDrive\Desktop\backendtest\OrdersAssessment\Orders.Api\Controllers\AuthController.cs:line 22
   at lambda_method9(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-10-03 15:06:36.017 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5238/api/Auth/register - 500 null text/plain; charset=utf-8 1019.5689ms
2025-10-03 15:11:35.845 +03:00 [INF] Application is shutting down...
2025-10-03 15:12:21.022 +03:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-10-03 15:12:21.111 +03:00 [INF] Executed DbCommand (14ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsLock' AND "type" = 'table';
2025-10-03 15:12:21.135 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT OR IGNORE INTO "__EFMigrationsLock"("Id", "Timestamp") VALUES(1, '2025-10-03 12:12:21.1259155+00:00');
SELECT changes();
2025-10-03 15:12:21.234 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" TEXT NOT NULL CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY,
    "ProductVersion" TEXT NOT NULL
);
2025-10-03 15:12:21.246 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-03 15:12:21.254 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-03 15:12:21.274 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-10-03 15:12:21.278 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "__EFMigrationsLock";
2025-10-03 15:12:21.429 +03:00 [INF] User profile is available. Using 'C:\Users\Zeink\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-10-03 15:12:21.576 +03:00 [INF] Now listening on: http://localhost:5238
2025-10-03 15:12:21.583 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-10-03 15:12:21.585 +03:00 [INF] Hosting environment: Development
2025-10-03 15:12:21.586 +03:00 [INF] Content root path: C:\Users\Zeink\OneDrive\Desktop\backendtest\OrdersAssessment\Orders.Api
2025-10-03 15:12:23.276 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5238/ - null null
2025-10-03 15:12:23.329 +03:00 [WRN] Failed to determine the https port for redirect.
2025-10-03 15:12:23.362 +03:00 [INF] Executing endpoint 'HTTP: GET /'
2025-10-03 15:12:23.367 +03:00 [INF] Executing RedirectResult, redirecting to /swagger.
2025-10-03 15:12:23.370 +03:00 [INF] Executed endpoint 'HTTP: GET /'
2025-10-03 15:12:23.375 +03:00 [INF] HTTP GET / responded 302 in 73.0598 ms
2025-10-03 15:12:23.385 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5238/ - 302 0 null 111.8152ms
2025-10-03 15:12:23.553 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5238/swagger/v1/swagger.json - null null
2025-10-03 15:12:23.734 +03:00 [INF] HTTP GET /swagger/v1/swagger.json responded 200 in 173.9478 ms
2025-10-03 15:12:23.739 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5238/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 185.7693ms
2025-10-03 15:44:33.457 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5238/api/Auth/register - application/json 73
2025-10-03 15:44:33.514 +03:00 [INF] Executing endpoint 'Orders.Api.Controllers.AuthController.Register (Orders.Api)'
2025-10-03 15:44:33.660 +03:00 [INF] Route matched with {action = "Register", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Orders.Application.DTOs.AuthResponse]] Register(Orders.Application.DTOs.RegisterRequest, System.Threading.CancellationToken) on controller Orders.Api.Controllers.AuthController (Orders.Api).
2025-10-03 15:44:34.470 +03:00 [INF] Executed DbCommand (18ms) [Parameters=[@__email_0='?' (Size = 14)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."Id", "u"."CreatedAtUtc", "u"."Email", "u"."FullName", "u"."PasswordHash", "u"."UpdatedAtUtc"
FROM "Users" AS "u"
WHERE "u"."Email" = @__email_0
LIMIT 1
2025-10-03 15:44:34.585 +03:00 [INF] Executing ConflictObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-03 15:44:34.620 +03:00 [INF] Executed action Orders.Api.Controllers.AuthController.Register (Orders.Api) in 951.2771ms
2025-10-03 15:44:34.623 +03:00 [INF] Executed endpoint 'Orders.Api.Controllers.AuthController.Register (Orders.Api)'
2025-10-03 15:44:34.626 +03:00 [INF] HTTP POST /api/Auth/register responded 409 in 1132.1654 ms
2025-10-03 15:44:34.635 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5238/api/Auth/register - 409 null application/json; charset=utf-8 1184.893ms
2025-10-03 15:44:46.082 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5238/api/Auth/register - application/json 74
2025-10-03 15:44:46.094 +03:00 [INF] Executing endpoint 'Orders.Api.Controllers.AuthController.Register (Orders.Api)'
2025-10-03 15:44:46.097 +03:00 [INF] Route matched with {action = "Register", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Orders.Application.DTOs.AuthResponse]] Register(Orders.Application.DTOs.RegisterRequest, System.Threading.CancellationToken) on controller Orders.Api.Controllers.AuthController (Orders.Api).
2025-10-03 15:44:46.187 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__email_0='?' (Size = 15)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."Id", "u"."CreatedAtUtc", "u"."Email", "u"."FullName", "u"."PasswordHash", "u"."UpdatedAtUtc"
FROM "Users" AS "u"
WHERE "u"."Email" = @__email_0
LIMIT 1
2025-10-03 15:44:46.466 +03:00 [INF] Executed DbCommand (12ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = DateTime), @p2='?' (Size = 15), @p3='?' (Size = 2), @p4='?' (Size = 84), @p5='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Users" ("Id", "CreatedAtUtc", "Email", "FullName", "PasswordHash", "UpdatedAtUtc")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-10-03 15:44:46.533 +03:00 [INF] Executing OkObjectResult, writing value of type 'Orders.Application.DTOs.AuthResponse'.
2025-10-03 15:44:46.546 +03:00 [INF] Executed action Orders.Api.Controllers.AuthController.Register (Orders.Api) in 443.8838ms
2025-10-03 15:44:46.549 +03:00 [INF] Executed endpoint 'Orders.Api.Controllers.AuthController.Register (Orders.Api)'
2025-10-03 15:44:46.551 +03:00 [INF] HTTP POST /api/Auth/register responded 200 in 461.2421 ms
2025-10-03 15:44:46.555 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5238/api/Auth/register - 200 null application/json; charset=utf-8 472.9602ms
2025-10-03 15:45:13.025 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5238/api/Auth/login - application/json 47
2025-10-03 15:45:13.033 +03:00 [INF] Executing endpoint 'Orders.Api.Controllers.AuthController.Login (Orders.Api)'
2025-10-03 15:45:13.044 +03:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Orders.Application.DTOs.AuthResponse]] Login(Orders.Application.DTOs.LoginRequest, System.Threading.CancellationToken) on controller Orders.Api.Controllers.AuthController (Orders.Api).
2025-10-03 15:45:13.060 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__email_0='?' (Size = 6)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."Id", "u"."CreatedAtUtc", "u"."Email", "u"."FullName", "u"."PasswordHash", "u"."UpdatedAtUtc"
FROM "Users" AS "u"
WHERE "u"."Email" = @__email_0
LIMIT 1
2025-10-03 15:45:13.065 +03:00 [INF] Executing UnauthorizedObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-03 15:45:13.068 +03:00 [INF] Executed action Orders.Api.Controllers.AuthController.Login (Orders.Api) in 20.2849ms
2025-10-03 15:45:13.072 +03:00 [INF] Executed endpoint 'Orders.Api.Controllers.AuthController.Login (Orders.Api)'
2025-10-03 15:45:13.075 +03:00 [INF] HTTP POST /api/Auth/login responded 401 in 42.0582 ms
2025-10-03 15:45:13.079 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5238/api/Auth/login - 401 null application/json; charset=utf-8 54.4684ms
2025-10-03 15:46:12.927 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5238/api/Auth/login - application/json 55
2025-10-03 15:46:12.934 +03:00 [INF] Executing endpoint 'Orders.Api.Controllers.AuthController.Login (Orders.Api)'
2025-10-03 15:46:12.936 +03:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Orders.Application.DTOs.AuthResponse]] Login(Orders.Application.DTOs.LoginRequest, System.Threading.CancellationToken) on controller Orders.Api.Controllers.AuthController (Orders.Api).
2025-10-03 15:46:12.944 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__email_0='?' (Size = 15)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."Id", "u"."CreatedAtUtc", "u"."Email", "u"."FullName", "u"."PasswordHash", "u"."UpdatedAtUtc"
FROM "Users" AS "u"
WHERE "u"."Email" = @__email_0
LIMIT 1
2025-10-03 15:46:13.040 +03:00 [INF] Executing OkObjectResult, writing value of type 'Orders.Application.DTOs.AuthResponse'.
2025-10-03 15:46:13.043 +03:00 [INF] Executed action Orders.Api.Controllers.AuthController.Login (Orders.Api) in 102.8201ms
2025-10-03 15:46:13.047 +03:00 [INF] Executed endpoint 'Orders.Api.Controllers.AuthController.Login (Orders.Api)'
2025-10-03 15:46:13.048 +03:00 [INF] HTTP POST /api/Auth/login responded 200 in 115.1009 ms
2025-10-03 15:46:13.052 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5238/api/Auth/login - 200 null application/json; charset=utf-8 125.492ms
2025-10-03 15:52:25.619 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5238/api/orders - null 0
2025-10-03 15:52:25.641 +03:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2025-10-03 15:52:25.652 +03:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-10-03 15:52:25.655 +03:00 [INF] HTTP POST /api/orders responded 401 in 30.2466 ms
2025-10-03 15:52:25.660 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5238/api/orders - 401 0 null 41.7193ms
2025-10-03 15:52:31.779 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5238/api/Auth/login - application/json 55
2025-10-03 15:52:31.785 +03:00 [INF] Executing endpoint 'Orders.Api.Controllers.AuthController.Login (Orders.Api)'
2025-10-03 15:52:31.788 +03:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Orders.Application.DTOs.AuthResponse]] Login(Orders.Application.DTOs.LoginRequest, System.Threading.CancellationToken) on controller Orders.Api.Controllers.AuthController (Orders.Api).
2025-10-03 15:52:31.800 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__email_0='?' (Size = 15)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."Id", "u"."CreatedAtUtc", "u"."Email", "u"."FullName", "u"."PasswordHash", "u"."UpdatedAtUtc"
FROM "Users" AS "u"
WHERE "u"."Email" = @__email_0
LIMIT 1
2025-10-03 15:52:31.913 +03:00 [INF] Executing OkObjectResult, writing value of type 'Orders.Application.DTOs.AuthResponse'.
2025-10-03 15:52:31.916 +03:00 [INF] Executed action Orders.Api.Controllers.AuthController.Login (Orders.Api) in 123.7268ms
2025-10-03 15:52:31.918 +03:00 [INF] Executed endpoint 'Orders.Api.Controllers.AuthController.Login (Orders.Api)'
2025-10-03 15:52:31.921 +03:00 [INF] HTTP POST /api/Auth/login responded 200 in 135.9527 ms
2025-10-03 15:52:31.924 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5238/api/Auth/login - 200 null application/json; charset=utf-8 144.9739ms
2025-10-03 15:54:02.133 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5238/api/Auth/login - application/json 55
2025-10-03 15:54:02.138 +03:00 [INF] Executing endpoint 'Orders.Api.Controllers.AuthController.Login (Orders.Api)'
2025-10-03 15:54:02.140 +03:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Orders.Application.DTOs.AuthResponse]] Login(Orders.Application.DTOs.LoginRequest, System.Threading.CancellationToken) on controller Orders.Api.Controllers.AuthController (Orders.Api).
2025-10-03 15:54:02.149 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__email_0='?' (Size = 15)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."Id", "u"."CreatedAtUtc", "u"."Email", "u"."FullName", "u"."PasswordHash", "u"."UpdatedAtUtc"
FROM "Users" AS "u"
WHERE "u"."Email" = @__email_0
LIMIT 1
2025-10-03 15:54:02.242 +03:00 [INF] Executing OkObjectResult, writing value of type 'Orders.Application.DTOs.AuthResponse'.
2025-10-03 15:54:02.245 +03:00 [INF] Executed action Orders.Api.Controllers.AuthController.Login (Orders.Api) in 100.3363ms
2025-10-03 15:54:02.247 +03:00 [INF] Executed endpoint 'Orders.Api.Controllers.AuthController.Login (Orders.Api)'
2025-10-03 15:54:02.249 +03:00 [INF] HTTP POST /api/Auth/login responded 200 in 111.6334 ms
2025-10-03 15:54:02.253 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5238/api/Auth/login - 200 null application/json; charset=utf-8 120.2136ms
2025-10-03 16:05:22.411 +03:00 [INF] Application is shutting down...
2025-10-03 16:05:56.075 +03:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-10-03 16:05:56.157 +03:00 [INF] Executed DbCommand (14ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsLock' AND "type" = 'table';
2025-10-03 16:05:56.174 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT OR IGNORE INTO "__EFMigrationsLock"("Id", "Timestamp") VALUES(1, '2025-10-03 13:05:56.1657783+00:00');
SELECT changes();
2025-10-03 16:05:56.241 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" TEXT NOT NULL CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY,
    "ProductVersion" TEXT NOT NULL
);
2025-10-03 16:05:56.252 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-03 16:05:56.259 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-03 16:05:56.274 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-10-03 16:05:56.278 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "__EFMigrationsLock";
2025-10-03 16:05:56.421 +03:00 [INF] User profile is available. Using 'C:\Users\Zeink\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-10-03 16:05:56.544 +03:00 [INF] Now listening on: http://localhost:5238
2025-10-03 16:05:56.548 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-10-03 16:05:56.550 +03:00 [INF] Hosting environment: Development
2025-10-03 16:05:56.551 +03:00 [INF] Content root path: C:\Users\Zeink\OneDrive\Desktop\backendtest\OrdersAssessment\Orders.Api
2025-10-03 16:06:00.608 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5238/ - null null
2025-10-03 16:06:00.665 +03:00 [WRN] Failed to determine the https port for redirect.
2025-10-03 16:06:00.739 +03:00 [INF] Executing endpoint 'HTTP: GET /'
2025-10-03 16:06:00.746 +03:00 [INF] Executing RedirectResult, redirecting to /swagger.
2025-10-03 16:06:00.748 +03:00 [INF] Executed endpoint 'HTTP: GET /'
2025-10-03 16:06:00.753 +03:00 [INF] HTTP GET / responded 302 in 115.7249 ms
2025-10-03 16:06:00.763 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5238/ - 302 0 null 156.8857ms
2025-10-03 16:06:00.938 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5238/swagger/v1/swagger.json - null null
2025-10-03 16:06:01.113 +03:00 [INF] HTTP GET /swagger/v1/swagger.json responded 200 in 167.3327 ms
2025-10-03 16:06:01.118 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5238/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 179.8915ms
2025-10-03 16:12:05.430 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5238/api/orders - null 0
2025-10-03 16:12:05.452 +03:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2025-10-03 16:12:05.462 +03:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-10-03 16:12:05.466 +03:00 [INF] HTTP POST /api/orders responded 401 in 25.9854 ms
2025-10-03 16:12:05.470 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5238/api/orders - 401 0 null 40.5237ms
2025-10-03 16:12:26.688 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5238/api/Auth/register - application/json 71
2025-10-03 16:12:26.697 +03:00 [INF] Executing endpoint 'Orders.Api.Controllers.AuthController.Register (Orders.Api)'
2025-10-03 16:12:26.736 +03:00 [INF] Route matched with {action = "Register", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Orders.Application.DTOs.AuthResponse]] Register(Orders.Application.DTOs.RegisterRequest, System.Threading.CancellationToken) on controller Orders.Api.Controllers.AuthController (Orders.Api).
2025-10-03 16:12:27.193 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__email_0='?' (Size = 6)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."Id", "u"."CreatedAtUtc", "u"."Email", "u"."FullName", "u"."PasswordHash", "u"."UpdatedAtUtc"
FROM "Users" AS "u"
WHERE "u"."Email" = @__email_0
LIMIT 1
2025-10-03 16:12:27.213 +03:00 [INF] Executed action Orders.Api.Controllers.AuthController.Register (Orders.Api) in 468.602ms
2025-10-03 16:12:27.216 +03:00 [INF] Executed endpoint 'Orders.Api.Controllers.AuthController.Register (Orders.Api)'
2025-10-03 16:12:27.220 +03:00 [ERR] HTTP POST /api/Auth/register responded 500 in 524.3955 ms
System.ArgumentException: Invalid email. (Parameter 'email')
   at Orders.Domain.Entities.User.SetEmail(String email) in C:\Users\Zeink\OneDrive\Desktop\backendtest\OrdersAssessment\Orders.Domain\Entities\User.cs:line 27
   at Orders.Domain.Entities.User..ctor(String email, String passwordHash, String fullName) in C:\Users\Zeink\OneDrive\Desktop\backendtest\OrdersAssessment\Orders.Domain\Entities\User.cs:line 19
   at Orders.Application.Services.AuthService.RegisterAsync(RegisterRequest req, CancellationToken ct) in C:\Users\Zeink\OneDrive\Desktop\backendtest\OrdersAssessment\Orders.Application\Services\AuthService.cs:line 31
   at Orders.Api.Controllers.AuthController.Register(RegisterRequest req, CancellationToken ct) in C:\Users\Zeink\OneDrive\Desktop\backendtest\OrdersAssessment\Orders.Api\Controllers\AuthController.cs:line 22
   at lambda_method9(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
2025-10-03 16:12:27.297 +03:00 [ERR] An unhandled exception has occurred while executing the request.
System.ArgumentException: Invalid email. (Parameter 'email')
   at Orders.Domain.Entities.User.SetEmail(String email) in C:\Users\Zeink\OneDrive\Desktop\backendtest\OrdersAssessment\Orders.Domain\Entities\User.cs:line 27
   at Orders.Domain.Entities.User..ctor(String email, String passwordHash, String fullName) in C:\Users\Zeink\OneDrive\Desktop\backendtest\OrdersAssessment\Orders.Domain\Entities\User.cs:line 19
   at Orders.Application.Services.AuthService.RegisterAsync(RegisterRequest req, CancellationToken ct) in C:\Users\Zeink\OneDrive\Desktop\backendtest\OrdersAssessment\Orders.Application\Services\AuthService.cs:line 31
   at Orders.Api.Controllers.AuthController.Register(RegisterRequest req, CancellationToken ct) in C:\Users\Zeink\OneDrive\Desktop\backendtest\OrdersAssessment\Orders.Api\Controllers\AuthController.cs:line 22
   at lambda_method9(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-10-03 16:12:27.326 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5238/api/Auth/register - 500 null text/plain; charset=utf-8 637.5921ms
2025-10-03 16:13:05.168 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5238/api/Auth/register - application/json 72
2025-10-03 16:13:05.178 +03:00 [INF] Executing endpoint 'Orders.Api.Controllers.AuthController.Register (Orders.Api)'
2025-10-03 16:13:05.181 +03:00 [INF] Route matched with {action = "Register", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Orders.Application.DTOs.AuthResponse]] Register(Orders.Application.DTOs.RegisterRequest, System.Threading.CancellationToken) on controller Orders.Api.Controllers.AuthController (Orders.Api).
2025-10-03 16:13:05.262 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__email_0='?' (Size = 7)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."Id", "u"."CreatedAtUtc", "u"."Email", "u"."FullName", "u"."PasswordHash", "u"."UpdatedAtUtc"
FROM "Users" AS "u"
WHERE "u"."Email" = @__email_0
LIMIT 1
2025-10-03 16:13:05.628 +03:00 [INF] Executed DbCommand (21ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = DateTime), @p2='?' (Size = 7), @p3='?' (Size = 6), @p4='?' (Size = 84), @p5='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Users" ("Id", "CreatedAtUtc", "Email", "FullName", "PasswordHash", "UpdatedAtUtc")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-10-03 16:13:05.694 +03:00 [INF] Executing OkObjectResult, writing value of type 'Orders.Application.DTOs.AuthResponse'.
2025-10-03 16:13:05.717 +03:00 [INF] Executed action Orders.Api.Controllers.AuthController.Register (Orders.Api) in 529.8913ms
2025-10-03 16:13:05.720 +03:00 [INF] Executed endpoint 'Orders.Api.Controllers.AuthController.Register (Orders.Api)'
2025-10-03 16:13:05.722 +03:00 [INF] HTTP POST /api/Auth/register responded 200 in 544.4350 ms
2025-10-03 16:13:05.725 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5238/api/Auth/register - 200 null application/json; charset=utf-8 556.9694ms
2025-10-03 16:18:13.897 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5238/api/Auth/register - application/json 72
2025-10-03 16:18:13.905 +03:00 [INF] Executing endpoint 'Orders.Api.Controllers.AuthController.Register (Orders.Api)'
2025-10-03 16:18:13.908 +03:00 [INF] Route matched with {action = "Register", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Orders.Application.DTOs.AuthResponse]] Register(Orders.Application.DTOs.RegisterRequest, System.Threading.CancellationToken) on controller Orders.Api.Controllers.AuthController (Orders.Api).
2025-10-03 16:18:13.921 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__email_0='?' (Size = 7)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."Id", "u"."CreatedAtUtc", "u"."Email", "u"."FullName", "u"."PasswordHash", "u"."UpdatedAtUtc"
FROM "Users" AS "u"
WHERE "u"."Email" = @__email_0
LIMIT 1
2025-10-03 16:18:13.936 +03:00 [INF] Executing ConflictObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-03 16:18:13.944 +03:00 [INF] Executed action Orders.Api.Controllers.AuthController.Register (Orders.Api) in 30.9521ms
2025-10-03 16:18:13.948 +03:00 [INF] Executed endpoint 'Orders.Api.Controllers.AuthController.Register (Orders.Api)'
2025-10-03 16:18:13.950 +03:00 [INF] HTTP POST /api/Auth/register responded 409 in 45.5453 ms
2025-10-03 16:18:13.953 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5238/api/Auth/register - 409 null application/json; charset=utf-8 56.2053ms
2025-10-03 16:18:43.997 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5238/api/Auth/login - application/json 48
2025-10-03 16:18:44.008 +03:00 [INF] Executing endpoint 'Orders.Api.Controllers.AuthController.Login (Orders.Api)'
2025-10-03 16:18:44.021 +03:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Orders.Application.DTOs.AuthResponse]] Login(Orders.Application.DTOs.LoginRequest, System.Threading.CancellationToken) on controller Orders.Api.Controllers.AuthController (Orders.Api).
2025-10-03 16:18:44.032 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__email_0='?' (Size = 7)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."Id", "u"."CreatedAtUtc", "u"."Email", "u"."FullName", "u"."PasswordHash", "u"."UpdatedAtUtc"
FROM "Users" AS "u"
WHERE "u"."Email" = @__email_0
LIMIT 1
2025-10-03 16:18:44.116 +03:00 [INF] Executing OkObjectResult, writing value of type 'Orders.Application.DTOs.AuthResponse'.
2025-10-03 16:18:44.119 +03:00 [INF] Executed action Orders.Api.Controllers.AuthController.Login (Orders.Api) in 93.5951ms
2025-10-03 16:18:44.122 +03:00 [INF] Executed endpoint 'Orders.Api.Controllers.AuthController.Login (Orders.Api)'
2025-10-03 16:18:44.124 +03:00 [INF] HTTP POST /api/Auth/login responded 200 in 116.1577 ms
2025-10-03 16:18:44.127 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5238/api/Auth/login - 200 null application/json; charset=utf-8 129.8684ms
2025-10-03 16:19:21.089 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5238/api/orders - null 0
2025-10-03 16:19:21.160 +03:00 [INF] Executing endpoint 'Orders.Api.Controllers.OrdersController.Create (Orders.Api)'
2025-10-03 16:19:21.167 +03:00 [INF] Route matched with {action = "Create", controller = "Orders"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Orders.Application.DTOs.OrderResponse]] Create(System.Threading.CancellationToken) on controller Orders.Api.Controllers.OrdersController (Orders.Api).
2025-10-03 16:19:21.211 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."Id", "u"."CreatedAtUtc", "u"."Email", "u"."FullName", "u"."PasswordHash", "u"."UpdatedAtUtc"
FROM "Users" AS "u"
WHERE "u"."Id" = @__id_0
LIMIT 1
2025-10-03 16:19:21.273 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = DateTime), @p2='?' (Size = 5), @p3='?' (DbType = Decimal), @p4='?' (DbType = DateTime), @p5='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Orders" ("Id", "CreatedAtUtc", "Status", "Total", "UpdatedAtUtc", "UserId")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-10-03 16:19:21.283 +03:00 [INF] Executing CreatedAtActionResult, writing value of type 'Orders.Application.DTOs.OrderResponse'.
2025-10-03 16:19:21.347 +03:00 [INF] Executed action Orders.Api.Controllers.OrdersController.Create (Orders.Api) in 176.7136ms
2025-10-03 16:19:21.350 +03:00 [INF] Executed endpoint 'Orders.Api.Controllers.OrdersController.Create (Orders.Api)'
2025-10-03 16:19:21.352 +03:00 [INF] HTTP POST /api/orders responded 201 in 257.2296 ms
2025-10-03 16:19:21.355 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5238/api/orders - 201 null application/json; charset=utf-8 266.0128ms
2025-10-03 16:32:11.123 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5238/api/orders/63a26df2-8a92-483a-935d-7b49be7aaeaa - null null
2025-10-03 16:32:11.133 +03:00 [INF] Executing endpoint 'Orders.Api.Controllers.OrdersController.GetById (Orders.Api)'
2025-10-03 16:32:11.140 +03:00 [INF] Route matched with {action = "GetById", controller = "Orders"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Orders.Application.DTOs.OrderResponse]] GetById(System.Guid, System.Threading.CancellationToken) on controller Orders.Api.Controllers.OrdersController (Orders.Api).
2025-10-03 16:32:11.257 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "o1"."Id", "o1"."CreatedAtUtc", "o1"."Status", "o1"."Total", "o1"."UpdatedAtUtc", "o1"."UserId", "o0"."Id", "o0"."CreatedAtUtc", "o0"."Name", "o0"."OrderId", "o0"."Quantity", "o0"."UnitPrice", "o0"."UpdatedAtUtc"
FROM (
    SELECT "o"."Id", "o"."CreatedAtUtc", "o"."Status", "o"."Total", "o"."UpdatedAtUtc", "o"."UserId"
    FROM "Orders" AS "o"
    WHERE "o"."Id" = @__id_0
    LIMIT 1
) AS "o1"
LEFT JOIN "OrderItems" AS "o0" ON "o1"."Id" = "o0"."OrderId"
ORDER BY "o1"."Id"
2025-10-03 16:32:11.270 +03:00 [INF] Executing OkObjectResult, writing value of type 'Orders.Application.DTOs.OrderResponse'.
2025-10-03 16:32:11.272 +03:00 [INF] Executed action Orders.Api.Controllers.OrdersController.GetById (Orders.Api) in 129.2676ms
2025-10-03 16:32:11.275 +03:00 [INF] Executed endpoint 'Orders.Api.Controllers.OrdersController.GetById (Orders.Api)'
2025-10-03 16:32:11.277 +03:00 [INF] HTTP GET /api/orders/63a26df2-8a92-483a-935d-7b49be7aaeaa responded 200 in 148.8942 ms
2025-10-03 16:32:11.281 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5238/api/orders/63a26df2-8a92-483a-935d-7b49be7aaeaa - 200 null application/json; charset=utf-8 158.3242ms
2025-10-03 16:32:22.218 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5238/api/me/orders - null null
2025-10-03 16:32:22.224 +03:00 [INF] Executing endpoint 'Orders.Api.Controllers.OrdersController.GetMyOrders (Orders.Api)'
2025-10-03 16:32:22.230 +03:00 [INF] Route matched with {action = "GetMyOrders", controller = "Orders"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.IReadOnlyList`1[Orders.Application.DTOs.OrderResponse]]] GetMyOrders(System.Threading.CancellationToken) on controller Orders.Api.Controllers.OrdersController (Orders.Api).
2025-10-03 16:32:22.266 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "o"."Id", "o"."CreatedAtUtc", "o"."Status", "o"."Total", "o"."UpdatedAtUtc", "o"."UserId", "o0"."Id", "o0"."CreatedAtUtc", "o0"."Name", "o0"."OrderId", "o0"."Quantity", "o0"."UnitPrice", "o0"."UpdatedAtUtc"
FROM "Orders" AS "o"
LEFT JOIN "OrderItems" AS "o0" ON "o"."Id" = "o0"."OrderId"
WHERE "o"."UserId" = @__userId_0
ORDER BY "o"."CreatedAtUtc" DESC, "o"."Id"
2025-10-03 16:32:22.274 +03:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Orders.Application.DTOs.OrderResponse, Orders.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-03 16:32:22.278 +03:00 [INF] Executed action Orders.Api.Controllers.OrdersController.GetMyOrders (Orders.Api) in 44.2656ms
2025-10-03 16:32:22.281 +03:00 [INF] Executed endpoint 'Orders.Api.Controllers.OrdersController.GetMyOrders (Orders.Api)'
2025-10-03 16:32:22.283 +03:00 [INF] HTTP GET /api/me/orders responded 200 in 59.1840 ms
2025-10-03 16:32:22.286 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5238/api/me/orders - 200 null application/json; charset=utf-8 68.2341ms
2025-10-03 16:32:44.571 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5238/api/orders/3fa85f64-5717-4562-b3fc-2c963f66afa6/items - application/json 57
2025-10-03 16:32:44.576 +03:00 [INF] Executing endpoint 'Orders.Api.Controllers.OrdersController.AddItem (Orders.Api)'
2025-10-03 16:32:44.583 +03:00 [INF] Route matched with {action = "AddItem", controller = "Orders"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Orders.Application.DTOs.OrderResponse]] AddItem(System.Guid, Orders.Application.DTOs.AddItemRequest, System.Threading.CancellationToken) on controller Orders.Api.Controllers.OrdersController (Orders.Api).
2025-10-03 16:32:44.626 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "o1"."Id", "o1"."CreatedAtUtc", "o1"."Status", "o1"."Total", "o1"."UpdatedAtUtc", "o1"."UserId", "o0"."Id", "o0"."CreatedAtUtc", "o0"."Name", "o0"."OrderId", "o0"."Quantity", "o0"."UnitPrice", "o0"."UpdatedAtUtc"
FROM (
    SELECT "o"."Id", "o"."CreatedAtUtc", "o"."Status", "o"."Total", "o"."UpdatedAtUtc", "o"."UserId"
    FROM "Orders" AS "o"
    WHERE "o"."Id" = @__id_0
    LIMIT 1
) AS "o1"
LEFT JOIN "OrderItems" AS "o0" ON "o1"."Id" = "o0"."OrderId"
ORDER BY "o1"."Id"
2025-10-03 16:32:44.632 +03:00 [INF] Executing ObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ProblemDetails'.
2025-10-03 16:32:44.665 +03:00 [INF] Executed action Orders.Api.Controllers.OrdersController.AddItem (Orders.Api) in 78.438ms
2025-10-03 16:32:44.667 +03:00 [INF] Executed endpoint 'Orders.Api.Controllers.OrdersController.AddItem (Orders.Api)'
2025-10-03 16:32:44.670 +03:00 [INF] HTTP POST /api/orders/3fa85f64-5717-4562-b3fc-2c963f66afa6/items responded 404 in 94.4072 ms
2025-10-03 16:32:44.673 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5238/api/orders/3fa85f64-5717-4562-b3fc-2c963f66afa6/items - 404 null application/problem+json; charset=utf-8 101.7986ms
2025-10-03 16:32:58.097 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5238/api/orders/63a26df2-8a92-483a-935d-7b49be7aaeaa/items - application/json 57
2025-10-03 16:32:58.103 +03:00 [INF] Executing endpoint 'Orders.Api.Controllers.OrdersController.AddItem (Orders.Api)'
2025-10-03 16:32:58.105 +03:00 [INF] Route matched with {action = "AddItem", controller = "Orders"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Orders.Application.DTOs.OrderResponse]] AddItem(System.Guid, Orders.Application.DTOs.AddItemRequest, System.Threading.CancellationToken) on controller Orders.Api.Controllers.OrdersController (Orders.Api).
2025-10-03 16:32:58.111 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "o1"."Id", "o1"."CreatedAtUtc", "o1"."Status", "o1"."Total", "o1"."UpdatedAtUtc", "o1"."UserId", "o0"."Id", "o0"."CreatedAtUtc", "o0"."Name", "o0"."OrderId", "o0"."Quantity", "o0"."UnitPrice", "o0"."UpdatedAtUtc"
FROM (
    SELECT "o"."Id", "o"."CreatedAtUtc", "o"."Status", "o"."Total", "o"."UpdatedAtUtc", "o"."UserId"
    FROM "Orders" AS "o"
    WHERE "o"."Id" = @__id_0
    LIMIT 1
) AS "o1"
LEFT JOIN "OrderItems" AS "o0" ON "o1"."Id" = "o0"."OrderId"
ORDER BY "o1"."Id"
2025-10-03 16:32:58.172 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = DateTime), @p2='?' (Size = 6), @p3='?' (DbType = Guid), @p4='?' (DbType = Int32), @p5='?' (DbType = Decimal), @p6='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "OrderItems" ("Id", "CreatedAtUtc", "Name", "OrderId", "Quantity", "UnitPrice", "UpdatedAtUtc")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
2025-10-03 16:32:58.177 +03:00 [INF] Executing OkObjectResult, writing value of type 'Orders.Application.DTOs.OrderResponse'.
2025-10-03 16:32:58.182 +03:00 [INF] Executed action Orders.Api.Controllers.OrdersController.AddItem (Orders.Api) in 72.794ms
2025-10-03 16:32:58.184 +03:00 [INF] Executed endpoint 'Orders.Api.Controllers.OrdersController.AddItem (Orders.Api)'
2025-10-03 16:32:58.186 +03:00 [INF] HTTP POST /api/orders/63a26df2-8a92-483a-935d-7b49be7aaeaa/items responded 200 in 83.6453 ms
2025-10-03 16:32:58.190 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5238/api/orders/63a26df2-8a92-483a-935d-7b49be7aaeaa/items - 200 null application/json; charset=utf-8 92.2406ms
2025-10-03 17:12:41.541 +03:00 [INF] Application is shutting down...
2025-10-03 17:16:26.718 +03:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-10-03 17:16:26.785 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsLock' AND "type" = 'table';
2025-10-03 17:16:26.808 +03:00 [INF] Executed DbCommand (15ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT OR IGNORE INTO "__EFMigrationsLock"("Id", "Timestamp") VALUES(1, '2025-10-03 14:16:26.7929216+00:00');
SELECT changes();
2025-10-03 17:16:26.896 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" TEXT NOT NULL CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY,
    "ProductVersion" TEXT NOT NULL
);
2025-10-03 17:16:26.908 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-03 17:16:26.916 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-03 17:16:26.931 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-10-03 17:16:26.936 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "__EFMigrationsLock";
2025-10-03 17:16:27.079 +03:00 [INF] User profile is available. Using 'C:\Users\Zeink\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-10-03 17:16:27.183 +03:00 [INF] Now listening on: http://localhost:5238
2025-10-03 17:16:27.187 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-10-03 17:16:27.189 +03:00 [INF] Hosting environment: Development
2025-10-03 17:16:27.191 +03:00 [INF] Content root path: C:\Users\Zeink\OneDrive\Desktop\backendtest\OrdersAssessment\Orders.Api
2025-10-03 17:17:51.930 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5238/ - null null
2025-10-03 17:17:52.006 +03:00 [WRN] Failed to determine the https port for redirect.
2025-10-03 17:17:52.080 +03:00 [INF] Executing endpoint 'HTTP: GET /'
2025-10-03 17:17:52.086 +03:00 [INF] Executing RedirectResult, redirecting to /swagger.
2025-10-03 17:17:52.088 +03:00 [INF] Executed endpoint 'HTTP: GET /'
2025-10-03 17:17:52.093 +03:00 [INF] HTTP GET / responded 302 in 120.5276 ms
2025-10-03 17:17:52.103 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5238/ - 302 0 null 175.6359ms
2025-10-03 17:17:52.269 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5238/swagger/v1/swagger.json - null null
2025-10-03 17:17:52.441 +03:00 [INF] HTTP GET /swagger/v1/swagger.json responded 200 in 164.7029 ms
2025-10-03 17:17:52.444 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5238/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 175.2312ms
2025-10-03 17:18:04.917 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5238/api/Auth/register - application/json 79
2025-10-03 17:18:04.931 +03:00 [INF] Executing endpoint 'Orders.Api.Controllers.AuthController.Register (Orders.Api)'
2025-10-03 17:18:04.969 +03:00 [INF] Route matched with {action = "Register", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Orders.Application.DTOs.AuthResponse]] Register(Orders.Application.DTOs.RegisterRequest, System.Threading.CancellationToken) on controller Orders.Api.Controllers.AuthController (Orders.Api).
2025-10-03 17:18:05.410 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__email_0='?' (Size = 14)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."Id", "u"."CreatedAtUtc", "u"."Email", "u"."FullName", "u"."PasswordHash", "u"."UpdatedAtUtc"
FROM "Users" AS "u"
WHERE "u"."Email" = @__email_0
LIMIT 1
2025-10-03 17:18:05.638 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = DateTime), @p2='?' (Size = 14), @p3='?' (Size = 8), @p4='?' (Size = 84), @p5='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Users" ("Id", "CreatedAtUtc", "Email", "FullName", "PasswordHash", "UpdatedAtUtc")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-10-03 17:18:05.712 +03:00 [INF] Executing OkObjectResult, writing value of type 'Orders.Application.DTOs.AuthResponse'.
2025-10-03 17:18:05.739 +03:00 [INF] Executed action Orders.Api.Controllers.AuthController.Register (Orders.Api) in 762.6599ms
2025-10-03 17:18:05.742 +03:00 [INF] Executed endpoint 'Orders.Api.Controllers.AuthController.Register (Orders.Api)'
2025-10-03 17:18:05.745 +03:00 [INF] HTTP POST /api/Auth/register responded 200 in 817.4264 ms
2025-10-03 17:18:05.754 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5238/api/Auth/register - 200 null application/json; charset=utf-8 836.5277ms
2025-10-03 17:18:27.225 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5238/api/Auth/login - application/json 55
2025-10-03 17:18:27.292 +03:00 [INF] Executing endpoint 'Orders.Api.Controllers.AuthController.Login (Orders.Api)'
2025-10-03 17:18:27.301 +03:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Orders.Application.DTOs.AuthResponse]] Login(Orders.Application.DTOs.LoginRequest, System.Threading.CancellationToken) on controller Orders.Api.Controllers.AuthController (Orders.Api).
2025-10-03 17:18:27.384 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__email_0='?' (Size = 14)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."Id", "u"."CreatedAtUtc", "u"."Email", "u"."FullName", "u"."PasswordHash", "u"."UpdatedAtUtc"
FROM "Users" AS "u"
WHERE "u"."Email" = @__email_0
LIMIT 1
2025-10-03 17:18:27.484 +03:00 [INF] Executing OkObjectResult, writing value of type 'Orders.Application.DTOs.AuthResponse'.
2025-10-03 17:18:27.488 +03:00 [INF] Executed action Orders.Api.Controllers.AuthController.Login (Orders.Api) in 183.1617ms
2025-10-03 17:18:27.490 +03:00 [INF] Executed endpoint 'Orders.Api.Controllers.AuthController.Login (Orders.Api)'
2025-10-03 17:18:27.493 +03:00 [INF] HTTP POST /api/Auth/login responded 200 in 258.9496 ms
2025-10-03 17:18:27.497 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5238/api/Auth/login - 200 null application/json; charset=utf-8 271.8137ms
2025-10-03 17:18:56.953 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5238/api/orders - null 0
2025-10-03 17:18:56.972 +03:00 [INF] Executing endpoint 'Orders.Api.Controllers.OrdersController.Create (Orders.Api)'
2025-10-03 17:18:56.980 +03:00 [INF] Route matched with {action = "Create", controller = "Orders"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Orders.Application.DTOs.OrderResponse]] Create(System.Threading.CancellationToken) on controller Orders.Api.Controllers.OrdersController (Orders.Api).
2025-10-03 17:18:57.023 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."Id", "u"."CreatedAtUtc", "u"."Email", "u"."FullName", "u"."PasswordHash", "u"."UpdatedAtUtc"
FROM "Users" AS "u"
WHERE "u"."Id" = @__id_0
LIMIT 1
2025-10-03 17:18:57.081 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = DateTime), @p2='?' (Size = 5), @p3='?' (DbType = Decimal), @p4='?' (DbType = DateTime), @p5='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Orders" ("Id", "CreatedAtUtc", "Status", "Total", "UpdatedAtUtc", "UserId")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-10-03 17:18:57.091 +03:00 [INF] Executing CreatedAtActionResult, writing value of type 'Orders.Application.DTOs.OrderResponse'.
2025-10-03 17:18:57.149 +03:00 [INF] Executed action Orders.Api.Controllers.OrdersController.Create (Orders.Api) in 164.5618ms
2025-10-03 17:18:57.152 +03:00 [INF] Executed endpoint 'Orders.Api.Controllers.OrdersController.Create (Orders.Api)'
2025-10-03 17:18:57.154 +03:00 [INF] HTTP POST /api/orders responded 201 in 194.1465 ms
2025-10-03 17:18:57.158 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5238/api/orders - 201 null application/json; charset=utf-8 204.2106ms
2025-10-03 17:19:35.384 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5238/api/orders/ee13c0bd-fd36-471c-b1be-ae0571fb9025 - null null
2025-10-03 17:19:35.394 +03:00 [INF] Executing endpoint 'Orders.Api.Controllers.OrdersController.GetById (Orders.Api)'
2025-10-03 17:19:35.405 +03:00 [INF] Route matched with {action = "GetById", controller = "Orders"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Orders.Application.DTOs.OrderResponse]] GetById(System.Guid, System.Threading.CancellationToken) on controller Orders.Api.Controllers.OrdersController (Orders.Api).
2025-10-03 17:19:35.496 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "o1"."Id", "o1"."CreatedAtUtc", "o1"."Status", "o1"."Total", "o1"."UpdatedAtUtc", "o1"."UserId", "o0"."Id", "o0"."CreatedAtUtc", "o0"."Name", "o0"."OrderId", "o0"."Quantity", "o0"."UnitPrice", "o0"."UpdatedAtUtc"
FROM (
    SELECT "o"."Id", "o"."CreatedAtUtc", "o"."Status", "o"."Total", "o"."UpdatedAtUtc", "o"."UserId"
    FROM "Orders" AS "o"
    WHERE "o"."Id" = @__id_0
    LIMIT 1
) AS "o1"
LEFT JOIN "OrderItems" AS "o0" ON "o1"."Id" = "o0"."OrderId"
ORDER BY "o1"."Id"
2025-10-03 17:19:35.508 +03:00 [INF] Executing OkObjectResult, writing value of type 'Orders.Application.DTOs.OrderResponse'.
2025-10-03 17:19:35.511 +03:00 [INF] Executed action Orders.Api.Controllers.OrdersController.GetById (Orders.Api) in 101.439ms
2025-10-03 17:19:35.515 +03:00 [INF] Executed endpoint 'Orders.Api.Controllers.OrdersController.GetById (Orders.Api)'
2025-10-03 17:19:35.517 +03:00 [INF] HTTP GET /api/orders/ee13c0bd-fd36-471c-b1be-ae0571fb9025 responded 200 in 127.1679 ms
2025-10-03 17:19:35.519 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5238/api/orders/ee13c0bd-fd36-471c-b1be-ae0571fb9025 - 200 null application/json; charset=utf-8 135.347ms
2025-10-03 17:19:46.203 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5238/api/me/orders - null null
2025-10-03 17:19:46.217 +03:00 [INF] Executing endpoint 'Orders.Api.Controllers.OrdersController.GetMyOrders (Orders.Api)'
2025-10-03 17:19:46.226 +03:00 [INF] Route matched with {action = "GetMyOrders", controller = "Orders"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.IReadOnlyList`1[Orders.Application.DTOs.OrderResponse]]] GetMyOrders(System.Threading.CancellationToken) on controller Orders.Api.Controllers.OrdersController (Orders.Api).
2025-10-03 17:19:46.273 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "o"."Id", "o"."CreatedAtUtc", "o"."Status", "o"."Total", "o"."UpdatedAtUtc", "o"."UserId", "o0"."Id", "o0"."CreatedAtUtc", "o0"."Name", "o0"."OrderId", "o0"."Quantity", "o0"."UnitPrice", "o0"."UpdatedAtUtc"
FROM "Orders" AS "o"
LEFT JOIN "OrderItems" AS "o0" ON "o"."Id" = "o0"."OrderId"
WHERE "o"."UserId" = @__userId_0
ORDER BY "o"."CreatedAtUtc" DESC, "o"."Id"
2025-10-03 17:19:46.282 +03:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Orders.Application.DTOs.OrderResponse, Orders.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-03 17:19:46.286 +03:00 [INF] Executed action Orders.Api.Controllers.OrdersController.GetMyOrders (Orders.Api) in 54.7962ms
2025-10-03 17:19:46.290 +03:00 [INF] Executed endpoint 'Orders.Api.Controllers.OrdersController.GetMyOrders (Orders.Api)'
2025-10-03 17:19:46.293 +03:00 [INF] HTTP GET /api/me/orders responded 200 in 79.4149 ms
2025-10-03 17:19:46.297 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5238/api/me/orders - 200 null application/json; charset=utf-8 94.6371ms
2025-10-03 17:20:05.092 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5238/api/orders/ee13c0bd-fd36-471c-b1be-ae0571fb9025/items - application/json 58
2025-10-03 17:20:05.105 +03:00 [INF] Executing endpoint 'Orders.Api.Controllers.OrdersController.AddItem (Orders.Api)'
2025-10-03 17:20:05.116 +03:00 [INF] Route matched with {action = "AddItem", controller = "Orders"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Orders.Application.DTOs.OrderResponse]] AddItem(System.Guid, Orders.Application.DTOs.AddItemRequest, System.Threading.CancellationToken) on controller Orders.Api.Controllers.OrdersController (Orders.Api).
2025-10-03 17:20:05.167 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "o1"."Id", "o1"."CreatedAtUtc", "o1"."Status", "o1"."Total", "o1"."UpdatedAtUtc", "o1"."UserId", "o0"."Id", "o0"."CreatedAtUtc", "o0"."Name", "o0"."OrderId", "o0"."Quantity", "o0"."UnitPrice", "o0"."UpdatedAtUtc"
FROM (
    SELECT "o"."Id", "o"."CreatedAtUtc", "o"."Status", "o"."Total", "o"."UpdatedAtUtc", "o"."UserId"
    FROM "Orders" AS "o"
    WHERE "o"."Id" = @__id_0
    LIMIT 1
) AS "o1"
LEFT JOIN "OrderItems" AS "o0" ON "o1"."Id" = "o0"."OrderId"
ORDER BY "o1"."Id"
2025-10-03 17:20:05.222 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = DateTime), @p2='?' (Size = 8), @p3='?' (DbType = Guid), @p4='?' (DbType = Int32), @p5='?' (DbType = Decimal), @p6='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "OrderItems" ("Id", "CreatedAtUtc", "Name", "OrderId", "Quantity", "UnitPrice", "UpdatedAtUtc")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
2025-10-03 17:20:05.229 +03:00 [INF] Executing OkObjectResult, writing value of type 'Orders.Application.DTOs.OrderResponse'.
2025-10-03 17:20:05.236 +03:00 [INF] Executed action Orders.Api.Controllers.OrdersController.AddItem (Orders.Api) in 115.1726ms
2025-10-03 17:20:05.239 +03:00 [INF] Executed endpoint 'Orders.Api.Controllers.OrdersController.AddItem (Orders.Api)'
2025-10-03 17:20:05.241 +03:00 [INF] HTTP POST /api/orders/ee13c0bd-fd36-471c-b1be-ae0571fb9025/items responded 200 in 137.3076 ms
2025-10-03 17:20:05.245 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5238/api/orders/ee13c0bd-fd36-471c-b1be-ae0571fb9025/items - 200 null application/json; charset=utf-8 153.577ms
2025-10-03 17:27:10.432 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5238/api/me/orders - null null
2025-10-03 17:27:10.439 +03:00 [INF] Executing endpoint 'Orders.Api.Controllers.OrdersController.GetMyOrders (Orders.Api)'
2025-10-03 17:27:10.442 +03:00 [INF] Route matched with {action = "GetMyOrders", controller = "Orders"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.IReadOnlyList`1[Orders.Application.DTOs.OrderResponse]]] GetMyOrders(System.Threading.CancellationToken) on controller Orders.Api.Controllers.OrdersController (Orders.Api).
2025-10-03 17:27:10.454 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__userId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "o"."Id", "o"."CreatedAtUtc", "o"."Status", "o"."Total", "o"."UpdatedAtUtc", "o"."UserId", "o0"."Id", "o0"."CreatedAtUtc", "o0"."Name", "o0"."OrderId", "o0"."Quantity", "o0"."UnitPrice", "o0"."UpdatedAtUtc"
FROM "Orders" AS "o"
LEFT JOIN "OrderItems" AS "o0" ON "o"."Id" = "o0"."OrderId"
WHERE "o"."UserId" = @__userId_0
ORDER BY "o"."CreatedAtUtc" DESC, "o"."Id"
2025-10-03 17:27:10.461 +03:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Orders.Application.DTOs.OrderResponse, Orders.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-03 17:27:10.464 +03:00 [INF] Executed action Orders.Api.Controllers.OrdersController.GetMyOrders (Orders.Api) in 17.7077ms
2025-10-03 17:27:10.468 +03:00 [INF] Executed endpoint 'Orders.Api.Controllers.OrdersController.GetMyOrders (Orders.Api)'
2025-10-03 17:27:10.470 +03:00 [INF] HTTP GET /api/me/orders responded 200 in 32.5483 ms
2025-10-03 17:27:10.474 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5238/api/me/orders - 200 null application/json; charset=utf-8 42.0948ms
2025-10-03 17:27:25.636 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5238/api/orders/ee13c0bd-fd36-471c-b1be-ae0571fb9025 - null null
2025-10-03 17:27:25.643 +03:00 [INF] Executing endpoint 'Orders.Api.Controllers.OrdersController.GetById (Orders.Api)'
2025-10-03 17:27:25.646 +03:00 [INF] Route matched with {action = "GetById", controller = "Orders"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Orders.Application.DTOs.OrderResponse]] GetById(System.Guid, System.Threading.CancellationToken) on controller Orders.Api.Controllers.OrdersController (Orders.Api).
2025-10-03 17:27:25.657 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "o1"."Id", "o1"."CreatedAtUtc", "o1"."Status", "o1"."Total", "o1"."UpdatedAtUtc", "o1"."UserId", "o0"."Id", "o0"."CreatedAtUtc", "o0"."Name", "o0"."OrderId", "o0"."Quantity", "o0"."UnitPrice", "o0"."UpdatedAtUtc"
FROM (
    SELECT "o"."Id", "o"."CreatedAtUtc", "o"."Status", "o"."Total", "o"."UpdatedAtUtc", "o"."UserId"
    FROM "Orders" AS "o"
    WHERE "o"."Id" = @__id_0
    LIMIT 1
) AS "o1"
LEFT JOIN "OrderItems" AS "o0" ON "o1"."Id" = "o0"."OrderId"
ORDER BY "o1"."Id"
2025-10-03 17:27:25.663 +03:00 [INF] Executing OkObjectResult, writing value of type 'Orders.Application.DTOs.OrderResponse'.
2025-10-03 17:27:25.666 +03:00 [INF] Executed action Orders.Api.Controllers.OrdersController.GetById (Orders.Api) in 12.6832ms
2025-10-03 17:27:25.669 +03:00 [INF] Executed endpoint 'Orders.Api.Controllers.OrdersController.GetById (Orders.Api)'
2025-10-03 17:27:25.670 +03:00 [INF] HTTP GET /api/orders/ee13c0bd-fd36-471c-b1be-ae0571fb9025 responded 200 in 27.8934 ms
2025-10-03 17:27:25.673 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5238/api/orders/ee13c0bd-fd36-471c-b1be-ae0571fb9025 - 200 null application/json; charset=utf-8 37.4101ms
2025-10-03 17:28:07.590 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5238/api/orders/ee13c0bd-fd36-471c-b1be-ae0571fb9025/items - application/json 54
2025-10-03 17:28:07.596 +03:00 [INF] Executing endpoint 'Orders.Api.Controllers.OrdersController.AddItem (Orders.Api)'
2025-10-03 17:28:07.598 +03:00 [INF] Route matched with {action = "AddItem", controller = "Orders"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Orders.Application.DTOs.OrderResponse]] AddItem(System.Guid, Orders.Application.DTOs.AddItemRequest, System.Threading.CancellationToken) on controller Orders.Api.Controllers.OrdersController (Orders.Api).
2025-10-03 17:28:07.632 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-10-03 17:28:07.681 +03:00 [INF] Executed action Orders.Api.Controllers.OrdersController.AddItem (Orders.Api) in 78.6365ms
2025-10-03 17:28:07.684 +03:00 [INF] Executed endpoint 'Orders.Api.Controllers.OrdersController.AddItem (Orders.Api)'
2025-10-03 17:28:07.686 +03:00 [INF] HTTP POST /api/orders/ee13c0bd-fd36-471c-b1be-ae0571fb9025/items responded 400 in 91.5325 ms
2025-10-03 17:28:07.689 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5238/api/orders/ee13c0bd-fd36-471c-b1be-ae0571fb9025/items - 400 null application/problem+json; charset=utf-8 99.2778ms
2025-10-03 17:28:33.546 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5238/api/orders/ee13c0bd-fd36-471c-b1be-ae0571fb9025/items - application/json 54
2025-10-03 17:28:33.555 +03:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2025-10-03 17:28:33.562 +03:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-10-03 17:28:33.566 +03:00 [INF] HTTP POST /api/orders/ee13c0bd-fd36-471c-b1be-ae0571fb9025/items responded 401 in 12.9674 ms
2025-10-03 17:28:33.570 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5238/api/orders/ee13c0bd-fd36-471c-b1be-ae0571fb9025/items - 401 0 null 24.3042ms
2025-10-03 17:29:20.662 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5238/api/Auth/register - application/json 79
2025-10-03 17:29:20.674 +03:00 [INF] Executing endpoint 'Orders.Api.Controllers.AuthController.Register (Orders.Api)'
2025-10-03 17:29:20.677 +03:00 [INF] Route matched with {action = "Register", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Orders.Application.DTOs.AuthResponse]] Register(Orders.Application.DTOs.RegisterRequest, System.Threading.CancellationToken) on controller Orders.Api.Controllers.AuthController (Orders.Api).
2025-10-03 17:29:20.687 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__email_0='?' (Size = 14)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."Id", "u"."CreatedAtUtc", "u"."Email", "u"."FullName", "u"."PasswordHash", "u"."UpdatedAtUtc"
FROM "Users" AS "u"
WHERE "u"."Email" = @__email_0
LIMIT 1
2025-10-03 17:29:20.778 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = DateTime), @p2='?' (Size = 14), @p3='?' (Size = 8), @p4='?' (Size = 84), @p5='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Users" ("Id", "CreatedAtUtc", "Email", "FullName", "PasswordHash", "UpdatedAtUtc")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-10-03 17:29:20.784 +03:00 [INF] Executing OkObjectResult, writing value of type 'Orders.Application.DTOs.AuthResponse'.
2025-10-03 17:29:20.787 +03:00 [INF] Executed action Orders.Api.Controllers.AuthController.Register (Orders.Api) in 105.056ms
2025-10-03 17:29:20.790 +03:00 [INF] Executed endpoint 'Orders.Api.Controllers.AuthController.Register (Orders.Api)'
2025-10-03 17:29:20.793 +03:00 [INF] HTTP POST /api/Auth/register responded 200 in 119.0608 ms
2025-10-03 17:29:20.797 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5238/api/Auth/register - 200 null application/json; charset=utf-8 135.2214ms
2025-10-03 17:29:51.703 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5238/api/orders - null 0
2025-10-03 17:29:51.715 +03:00 [INF] Executing endpoint 'Orders.Api.Controllers.OrdersController.Create (Orders.Api)'
2025-10-03 17:29:51.719 +03:00 [INF] Route matched with {action = "Create", controller = "Orders"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Orders.Application.DTOs.OrderResponse]] Create(System.Threading.CancellationToken) on controller Orders.Api.Controllers.OrdersController (Orders.Api).
2025-10-03 17:29:51.728 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."Id", "u"."CreatedAtUtc", "u"."Email", "u"."FullName", "u"."PasswordHash", "u"."UpdatedAtUtc"
FROM "Users" AS "u"
WHERE "u"."Id" = @__id_0
LIMIT 1
2025-10-03 17:29:51.737 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = DateTime), @p2='?' (Size = 5), @p3='?' (DbType = Decimal), @p4='?' (DbType = DateTime), @p5='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Orders" ("Id", "CreatedAtUtc", "Status", "Total", "UpdatedAtUtc", "UserId")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-10-03 17:29:51.742 +03:00 [INF] Executing CreatedAtActionResult, writing value of type 'Orders.Application.DTOs.OrderResponse'.
2025-10-03 17:29:51.748 +03:00 [INF] Executed action Orders.Api.Controllers.OrdersController.Create (Orders.Api) in 23.4641ms
2025-10-03 17:29:51.750 +03:00 [INF] Executed endpoint 'Orders.Api.Controllers.OrdersController.Create (Orders.Api)'
2025-10-03 17:29:51.753 +03:00 [INF] HTTP POST /api/orders responded 201 in 40.0271 ms
2025-10-03 17:29:51.756 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5238/api/orders - 201 null application/json; charset=utf-8 52.5967ms
2025-10-03 17:30:13.084 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5238/api/orders/ee13c0bd-fd36-471c-b1be-ae0571fb9025 - null null
2025-10-03 17:30:13.091 +03:00 [INF] Executing endpoint 'Orders.Api.Controllers.OrdersController.GetById (Orders.Api)'
2025-10-03 17:30:13.100 +03:00 [INF] Route matched with {action = "GetById", controller = "Orders"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Orders.Application.DTOs.OrderResponse]] GetById(System.Guid, System.Threading.CancellationToken) on controller Orders.Api.Controllers.OrdersController (Orders.Api).
2025-10-03 17:30:13.108 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT "o1"."Id", "o1"."CreatedAtUtc", "o1"."Status", "o1"."Total", "o1"."UpdatedAtUtc", "o1"."UserId", "o0"."Id", "o0"."CreatedAtUtc", "o0"."Name", "o0"."OrderId", "o0"."Quantity", "o0"."UnitPrice", "o0"."UpdatedAtUtc"
FROM (
    SELECT "o"."Id", "o"."CreatedAtUtc", "o"."Status", "o"."Total", "o"."UpdatedAtUtc", "o"."UserId"
    FROM "Orders" AS "o"
    WHERE "o"."Id" = @__id_0
    LIMIT 1
) AS "o1"
LEFT JOIN "OrderItems" AS "o0" ON "o1"."Id" = "o0"."OrderId"
ORDER BY "o1"."Id"
2025-10-03 17:30:13.116 +03:00 [INF] Executing ObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ProblemDetails'.
2025-10-03 17:30:13.123 +03:00 [INF] Executed action Orders.Api.Controllers.OrdersController.GetById (Orders.Api) in 18.3958ms
2025-10-03 17:30:13.127 +03:00 [INF] Executed endpoint 'Orders.Api.Controllers.OrdersController.GetById (Orders.Api)'
2025-10-03 17:30:13.130 +03:00 [INF] HTTP GET /api/orders/ee13c0bd-fd36-471c-b1be-ae0571fb9025 responded 404 in 40.2411 ms
2025-10-03 17:30:13.135 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5238/api/orders/ee13c0bd-fd36-471c-b1be-ae0571fb9025 - 404 null application/problem+json; charset=utf-8 51.1045ms
2025-10-03 17:54:35.659 +03:00 [INF] Application is shutting down...
2025-10-03 18:44:19.182 +03:00 [WRN] The foreign key property 'Order.UserId1' was created in shadow state because a conflicting property with the simple name 'UserId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-10-03 18:44:38.119 +03:00 [WRN] The foreign key property 'Order.UserId1' was created in shadow state because a conflicting property with the simple name 'UserId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-10-03 18:44:38.447 +03:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-10-03 18:44:38.486 +03:00 [INF] Executed DbCommand (18ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsLock' AND "type" = 'table';
2025-10-03 18:44:38.507 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT OR IGNORE INTO "__EFMigrationsLock"("Id", "Timestamp") VALUES(1, '2025-10-03 15:44:38.497902+00:00');
SELECT changes();
2025-10-03 18:44:38.602 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" TEXT NOT NULL CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY,
    "ProductVersion" TEXT NOT NULL
);
2025-10-03 18:44:38.614 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-03 18:44:38.621 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-03 18:44:38.644 +03:00 [INF] Applying migration '20251003154420_AddAuditEvents'.
2025-10-03 18:44:38.686 +03:00 [WRN] The migration operation 'PRAGMA foreign_keys = 0;
' from migration 'AddAuditEvents' cannot be executed in a transaction. If the app is terminated or an unrecoverable error occurs while this operation is being executed then the migration will be left in a partially applied state and would need to be reverted manually before it can be applied again. Create a separate migration that contains just this operation.
2025-10-03 18:44:38.690 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE "Orders" ADD "UserId1" TEXT NULL;
2025-10-03 18:44:38.696 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE "AuditEvents" (
    "Id" TEXT NOT NULL CONSTRAINT "PK_AuditEvents" PRIMARY KEY,
    "UserId" TEXT NULL,
    "Action" TEXT NOT NULL,
    "OrderId" TEXT NULL,
    "DetailsJson" TEXT NULL,
    "CreatedAtUtc" TEXT NOT NULL,
    "UpdatedAtUtc" TEXT NULL
);
2025-10-03 18:44:38.701 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX "IX_Orders_UserId1" ON "Orders" ("UserId1");
2025-10-03 18:44:38.706 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX "IX_AuditEvents_CreatedAtUtc" ON "AuditEvents" ("CreatedAtUtc");
2025-10-03 18:44:38.711 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX "IX_AuditEvents_OrderId" ON "AuditEvents" ("OrderId");
2025-10-03 18:44:38.715 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX "IX_AuditEvents_UserId" ON "AuditEvents" ("UserId");
2025-10-03 18:44:38.720 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE "ef_temp_Orders" (
    "Id" TEXT NOT NULL CONSTRAINT "PK_Orders" PRIMARY KEY,
    "CreatedAtUtc" TEXT NOT NULL,
    "Status" TEXT NOT NULL,
    "Total" TEXT NOT NULL,
    "UpdatedAtUtc" TEXT NULL,
    "UserId" TEXT NOT NULL,
    "UserId1" TEXT NULL,
    CONSTRAINT "FK_Orders_Users_UserId" FOREIGN KEY ("UserId") REFERENCES "Users" ("Id") ON DELETE CASCADE,
    CONSTRAINT "FK_Orders_Users_UserId1" FOREIGN KEY ("UserId1") REFERENCES "Users" ("Id")
);
2025-10-03 18:44:38.725 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "ef_temp_Orders" ("Id", "CreatedAtUtc", "Status", "Total", "UpdatedAtUtc", "UserId", "UserId1")
SELECT "Id", "CreatedAtUtc", "Status", "Total", "UpdatedAtUtc", "UserId", "UserId1"
FROM "Orders";
2025-10-03 18:44:38.735 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
PRAGMA foreign_keys = 0;
2025-10-03 18:44:38.740 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DROP TABLE "Orders";
2025-10-03 18:44:38.745 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE "ef_temp_Orders" RENAME TO "Orders";
2025-10-03 18:44:38.753 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
PRAGMA foreign_keys = 1;
2025-10-03 18:44:38.757 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX "IX_Orders_UserId_CreatedAtUtc" ON "Orders" ("UserId", "CreatedAtUtc");
2025-10-03 18:44:38.762 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX "IX_Orders_UserId1" ON "Orders" ("UserId1");
2025-10-03 18:44:38.771 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "__EFMigrationsHistory" ("MigrationId", "ProductVersion")
VALUES ('20251003154420_AddAuditEvents', '9.0.9');
2025-10-03 18:44:38.777 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "__EFMigrationsLock";
